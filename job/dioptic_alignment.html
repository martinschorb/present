<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Framework zur Alignierung von Volumen-Bilddaten</title>

		<meta name="description" content="Test presentation 1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="../reveal.js-master/dist/reset.css">
		<link rel="stylesheet" href="../reveal.js-master/dist/reveal.css">
		<link rel="stylesheet" href="../reveal.js-master/dist/theme/sky_bright.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../reveal.js-master/plugin/highlight/monokai.css">
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-markdown>
					<textarea data-template>

						### Implementierung eines Frameworks zur Alignierung von Volumen-Bilddaten

						----

						Martin Schorb, 10.4.2025
						---

						### Serial Block-face scanning EM

						![img](./img/sbem_01.png)

						---

						### Martin

						| | | |
						|--|--|--|
						|![img](img/sax.jpg)|![img](img/rad.jpg)|![img](img/garten.png)|

						---

						### Martin (Karriere)

						| | | | |
						|--|--|--|--|
						|<img style="display: inline; width: 2700px" src="./img/physik.jpg">|<img style="display: inline; width: 2000px" src="./img/fm_lego.webp">|<img style="display: inline; width: 2200px" src="./img/tem_lego.jpg">|![img](img/programmer.png)|

						---

						### Implementierung eines Frameworks zur Alignierung von Volumen-Bilddaten

						----

						Martin Schorb, 10.4.2025
						---

						### Serial Block-face scanning EM
						
						![img](./img/sbem_01.png)

						---
						### Aufnahmesoftware

						![img](./img/sbemimage.png)
					</textarea>
				</section>

				<section data-background-iframe="https://webknossos.org/datasets/l4dense_motta_et_al_demo-5f33d5340100001800e8cddc/view#3623,3883,1792,0,1.3" data-background-interactive>
					<div style="position: fixed; height: 70px; left:200px; bottom: -110px ; box-shadow: 0 1px 4px rgba(0,0,0,0.5), 0 5px 25px rgba(0,0,0,0.2); background-color: #bcd5ee; color: #555; padding: 20px; font-size: 20px; text-align: center;">
						<h3>Ergebnis</h3>
						<p>Perfekt aligniertes Volumen; <span class="fragment highlight-red">Next-Gen FileFormat (NGFF) = OME-Zarr</span></p>
					</div>
					<div style="position: fixed; height: 30px; left:200px; bottom: -700px ; box-shadow: 0 1px 4px rgba(0,0,0,0.5), 0 5px 25px rgba(0,0,0,0.2); background-color: #bcd5ee; color: #555; padding: 3px; text-align: center;">
						<p style="font-family: courier; font-size: 7pt">https://webknossos.org/datasets/l4dense_motta_et_al_demo-5f33d5340100001800e8cddc/view#3623,3883,1792,0,1.3</p>
					</div>
				</section>

				<section data-markdown>
					<textarea data-template>
						### Ist-Zustand:
						- Alignment von: <br>
						2D Mosaik (10&times;10) 3D Schnitte (~10.000)
						- von Hand in TrakEM (Fiji) importiert
						- Dauer Alignment: <br>
						mehrere Wochen (lokale Workstation)
						- manuelle Konvertierung (Tage)

						---

						### Welche Tools existieren?

						<img style="display: inline; width: 800px; margin: 0;" src="./img/brain1.png">
						<img style="display: inline; width: 800px; margin: 0;" src="./img/brain2.png">

						| | |
						|--|--|
						| <img style="display: inline; width: 200px; margin: 0;" src="./img/allen.png">  | <img style="display: inline; width: 100px; margin: -12pt;" src="./img/janelia.png"> |

				</textarea>
				</section>

				<section data-background-iframe="./web_data/Big 3D Stitching - Image Analysis - Image.sc Forum.html" data-background-interactive>
					<div style="position: relative; width: 20%; left: -7% ; box-shadow: 0 1px 4px rgba(0,0,0,0.5), 0 5px 25px rgba(0,0,0,0.2); background-color: #bcd5ee; color: #555; padding: 20px; font-size: 20px; text-align: left;">
						<h2>Kontakt:</h2>
						<p style="font-family: courier; font-size: 17pt">image.sc</p>
						<p>Erreichbarkeit der Entwickler?</p>
					</div>
				</section>
				<section data-auto-animate>
					<h3>Architektur</h3>
					<div class="r-stack">
						<img class="fragment" style="display: inline; margin: 0;" class="r-stretch" src="./img/Render_scheme1.svg">
						<img class="fragment" style="display: inline; margin: 0;" class="r-stretch" src="./img/Render_scheme0.svg">
					</div>
				</section>

				<section data-auto-animate>
					<h3>Render web services</h3>
						<img style="margin: 0" class="r-stretch" src="./img/render_web1.png">
				</section>
				<section data-auto-animate>
					<h3>Render web services</h3>
						<img style="margin: 0" class="r-stretch" src="./img/render_web2.png">
				</section>
				<section>
					<section data-background-iframe="https://dash.gallery/dash-covid-xray/" data-background-interactive>
						<div style="position: relative; width: 43%; left:50%; bottom: 200pt ; box-shadow: 0 1px 4px rgba(0,0,0,0.5), 0 5px 25px rgba(0,0,0,0.2); background-color: #bcd5ee; color: #555; padding: 20px; font-size: 20px; text-align: center;">
							<h3><span class="fragment highlight-red">Dash</span></h3>
							<p>Python framework for interactive data apps</p>
						</div>
					</section>
					<section data-background-iframe="https://dash.plotly.com/minimal-app" data-background-interactive>

					</section>

				</section>
				<section data-background-iframe="http://127.0.0.1:8050/" data-background-interactive>
<!--					<div style="position: absolute; width: 500px; left:500px; bottom: 210px ; box-shadow: 0 1px 4px rgba(0,0,0,0.5), 0 5px 25px rgba(0,0,0,0.2); background-color: #bcd5ee; color: #555; padding: 20px; font-size: 20px; text-align: center;">-->
<!--						<h3><span class="fragment highlight-red">Dash</span></h3>-->
<!--						<p>Python framework for interactive data apps.</p>-->
<!--					</div>-->
				</section>

				<section data-auto-animate>
					<h3>workflow</h3>
					<p class="fragment fade-in-then-semi-out"><img style="margin: 0" src="./img/render_flow1.svg"></p>
					<p class="fragment fade-in-then-semi-out"><img style="margin: 0" src="./img/render_flow2.svg"></p>
					<p class="fragment fade-in-then-semi-out"><img style="margin: 0" src="./img/render_flow3.svg"></p>
					<p class="fragment fade-in-then-semi-out"><img style="margin: 0" src="./img/render_flow4.svg"></p>
					<p class="fragment fade-in-then-semi-out"><img style="margin: 0" src="./img/render_flow5.svg"></p>

				</section>

				<section>
					<h3>Backend Code</h3>
					 <ul>
						  <li><p>Python API für Render (API und client Scripts)</p></li>
						  <li><p class="fragment highlight-current-blue" data-fragment-index="3">Python Paket zur Anwendung</p></li>
						  <li><p class="fragment highlight-current-blue" data-fragment-index="2">Launcher für lokale, HPC, Spark</p></li>
					 </ul>

				</section>
				<section>
					<section data-markdown>
						<script type="text/template" >

### Resultate

- Implementierung von SBEM (u.a.) Importern
- parallel auf Cluster <!-- .element: class="fragment" -->
- Dauer: Wochen &#128201; Stunden &#128640; <!-- .element: class="fragment" -->
- Bedienung über Web-UI <!-- .element: class="fragment" -->

---

### große TEM Mosaike
![img](img/serialem_render.png)

						</script>
					</section>
				</section>
				<section>
					<section data-markdown>
						<script type="text/template">
							### `argschema`
							entwickelt am Allen Institute
							- verifizieren von Input-Parametern (Typ, Wert)
							- Parameter
								- Funktionsparameter <!-- .element: class="fragment" -->
								- Dictionary <!-- .element: class="fragment" -->
								- Kommandozeile (argparse) <!-- .element: class="fragment" -->
								- JSON Datei <!-- .element: class="fragment" -->
							- automatische Dokumentation (Sphinx) <!-- .element: class="fragment" -->

						</script>
						</section>
						<section>
							<h3>Use case</h3>
							<ul>
								<li><p>JuPyter NB gebastelt , läuft, static filenames (check?)</p></li>
								<li><p class="fragment">Variablen nach oben, Funktions-Wrap</p></li>
								<li><p class="fragment">Kommandozeile wäre schön (argparse), Validierung?</p></li>
								<li><p class="fragment">Einbetten in andere Module, argparse-Code?</p></li>
								<li><p class="fragment">Parameter für Batch-Processing? (JSON)</p></li>

							</ul>
							<aside class="notes">
								- file doesn't exist, and your code doesn't check for the existence<br>
								- argparse, help<br>
								- change your original module a little bit, fix up the others?


							</aside>
						</section>
				</section>




				<section data-markdown style="width:120%;left:-14% ;font-size:26pt">
					<script type="text/template" >
						#### `argschema` - Beispiel

						<table style="width:110%">
<tr>
<th style="width:43%">Klasse</th>
<th style="width:52%">Schema</th>
</tr>
<tr>
<td>

```python
from argschema import ArgSchemaParser
from .schema import TwoNumbers

class Multiply(ArgSchemaParser):
    default_schema = TwoNumbers
    def run(self):
        num1 = self.args.get("a")
        num2 = self.args.get("b")

        print(str(num1 * num2))

```

</td>
<td>

```python
from aschema.schemas import ArgSchema
from aschema.fields import Int

class TwoNumbers(ArgSchema):
  a = Int(default=2,
  	  required=True,
	  description='First number (int).')
  b = Int(default=3,
	  required=True,
	  description='Second number (int).')
```

</td>
</tr>
</table>

						```Python
						t1 = Multiply()
						t1.run()
							6
						t2 = Multiply(input_data={'a':5})
						t2.run()
							15
						t3 = Multiply(input_data={'a':"some string"})
							marshmallow.exceptions.ValidationError: {'a': ['Not a valid integer.']}
						```

						<!-- .element: class="fragment" -->


					</script>
					</section>




				<section data-markdown style="width:120%; left:-14% ;font-size:25pt">
					<script type="text/template" >
					### Kommandozeile
```Python
if __name__ == "__main__":
    k=Multiply()
    k.run()
```


```ini

$ python argsch_demo.py
	6

$ python argsch_demo.py  --h
usage: argsch_demo.py [-h] [--a A] [--b B] [--input_json INPUT_JSON] [--output_json OUTPUT_JSON] [--log_level LOG_LEVEL]

options:
  -h, --help            show this help message and exit

TwoNumbers:
  --a A                 First number (int). (default=2) (REQUIRED)
  --b B                 Second number (int). (default=3) (REQUIRED)
  --input_json INPUT_JSON
                        file path of input json file
  --output_json OUTPUT_JSON
                        file path to output json file
  --log_level LOG_LEVEL
                        set the logging level of the module (default=ERROR)


$ python argsch_demo.py --a 4
	12

$ echo {\"b\": 5} > params.json
$ python argsch_demo.py  --input_json params.json
	10

```
					<!-- .element: class="fragment" -->

					</script>
				</section>

				<section data-markdown>
					<textarea data-template>
						### NGFF
						![img](img/ome-zarr1.webp)
					</textarea>
				</section>


			</div>

		</div>

		<script src="../reveal.js-master/dist/reveal.js"></script>
		<script src="../reveal.js-master/plugin/zoom/zoom.js"></script>
		<script src="../reveal.js-master/plugin/notes/notes.js"></script>
		<script src="../reveal.js-master/plugin/search/search.js"></script>
		<script src="../reveal.js-master/plugin/markdown/markdown.js"></script>
		<script src="../reveal.js-master/plugin/math/math.js"></script>
		<script src="../reveal.js-master/plugin/math/tex-chtml.js"></script>
		<script src="../reveal.js-master/plugin/highlight/highlight.js"></script>
		<script>

			// Also available as an ES module, see:
			// https://revealjs.com/initialization/
			Reveal.initialize({
				controls: false,
				progress: true,
				center: true,
				hash: true,
				slideNumber: false,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight]
			});

		</script>

	</body>
</html>
