define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter",["exports","discourse/adapters/rest"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{basePath(){return"/discourse-post-event/"}}e.default=s})),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-event",["exports","@ember/string","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends s.default{pathFor(e,s,i){const n=this.basePath(e,s,i)+(0,t.underscore)(e.pluralize(this.apiNameFor(s)))
return this.appendQueryParams(n,i)}apiNameFor(){return"event"}}e.default=i})),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-invitee",["exports","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{apiNameFor(){return"invitee"}}e.default=s})),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter",["exports","@ember/string","discourse/adapters/rest","discourse/lib/ajax","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends n.default{destroyRecord(e,t,s){return(0,i.ajax)(this.pathFor(e,t,{post_id:s.post_id,id:s.id}),{type:"DELETE"})}update(e,n,o,r){const a={},d=(0,t.underscore)(this.apiNameFor(n))
return a[d]=r,(0,i.ajax)(this.pathFor(e,n,{id:o,post_id:r.post_id}),this.getPayload("PUT",a)).then((function(e){return new s.Result(e[d],e)}))}createRecord(e,n,o){const r={},a=(0,t.underscore)(this.apiNameFor(n))
return r[a]=o,(0,i.ajax)(this.pathFor(e,n,o),this.getPayload("POST",r)).then((function(e){return new s.Result(e[a],e)}))}pathFor(e,s,i){const n=i.post_id
delete i.post_id
const o=i.id
delete i.id
let r=this.basePath(e,s,{})+"events/"+n+"/"+(0,t.underscore)(e.pluralize(this.apiNameFor()))
return o&&(r+=`/${o}`),this.appendQueryParams(r,i)}}e.default=o})),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-reminder",["exports","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{apiNameFor(){return"reminder"}}e.default=s})),define("discourse/plugins/discourse-calendar/discourse/adapters/templates/connectors/category-custom-settings/show-event-category-sorting-settings",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"ouS7OpuH",block:'[[[41,[28,[37,1],[[30,0,["siteSettings","sort_categories_by_event_start_date_enabled"]],[30,0,["siteSettings","disable_resorting_on_categories_enabled"]]],null],[[[1,"  "],[10,"section"],[12],[1,"\\n    "],[10,"h3"],[12],[1,[28,[35,4],["discourse_post_event.category.settings_sections.event_sorting"],null]],[13],[1,"\\n\\n"],[41,[30,0,["siteSettings","sort_categories_by_event_start_date_enabled"]],[[[1,"      "],[10,"section"],[14,0,"field show-subcategory-list-field"],[12],[1,"\\n        "],[10,"label"],[12],[1,"\\n          "],[8,[39,6],null,[["@type","@checked"],["checkbox",[30,0,["category","custom_fields","sort_topics_by_event_start_date"]]]],null],[1,"\\n          "],[1,[28,[35,4],["discourse_post_event.category.sort_topics_by_event_start_date"],null]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["siteSettings","disable_resorting_on_categories_enabled"]],[[[1,"      "],[10,"section"],[14,0,"field show-subcategory-list-field"],[12],[1,"\\n        "],[10,"label"],[12],[1,"\\n          "],[8,[39,6],null,[["@type","@checked"],["checkbox",[30,0,["category","custom_fields","disable_topic_resorting"]]]],null],[1,"\\n          "],[1,[28,[35,4],["discourse_post_event.category.disable_topic_resorting"],null]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],[],false,["if","or","section","h3","i18n","label","input"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/adapters/templates/connectors/category-custom-settings/show-event-category-sorting-settings.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-calendar/discourse/admin-calendar-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"admin.adminPlugins",path:"/plugins",map(){this.route("calendar")}}})),define("discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list-item",["exports","@ember/component","@ember/object","@ember-decorators/component","discourse/lib/ajax","discourse/lib/ajax-error","@ember/template-factory"],(function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,r.createTemplateFactory)({id:"QyaZfy3+",block:'[[[10,"td"],[12],[1,[30,0,["holiday","date"]]],[13],[1,"\\n"],[10,"td"],[12],[1,[30,0,["holiday","name"]]],[13],[1,"\\n"],[10,"td"],[12],[1,"\\n"],[41,[30,0,["isHolidayDisabled"]],[[[1,"    "],[8,[39,2],null,[["@action","@label"],[[28,[37,3],[[30,0],"enableHoliday",[30,0,["holiday"]],[30,0,["region_code"]]],null],"discourse_calendar.enable_holiday"]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,2],null,[["@action","@label"],[[28,[37,3],[[30,0],"disableHoliday",[30,0,["holiday"]],[30,0,["region_code"]]],null],"discourse_calendar.disable_holiday"]],null],[1,"\\n"]],[]]],[13]],[],false,["td","if","d-button","action"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list-item.hbs",isStrictMode:!1}),d=dt7948.c(class extends t.default{loading=!1
isHolidayDisabled=!1
disableHoliday(e,t){if(!this.loading)return this.set("loading",!0),(0,n.ajax)({url:"/admin/discourse-calendar/holidays/disable",type:"POST",data:{disabled_holiday:{holiday_name:e.name,region_code:t}}}).then((()=>this.set("isHolidayDisabled",!0))).catch(o.popupAjaxError).finally((()=>this.set("loading",!1)))}static#e=(()=>dt7948.n(this.prototype,"disableHoliday",[s.action]))()
enableHoliday(e,t){if(!this.loading)return this.set("loading",!0),(0,n.ajax)({url:"/admin/discourse-calendar/holidays/enable",type:"DELETE",data:{disabled_holiday:{holiday_name:e.name,region_code:t}}}).then((()=>this.set("isHolidayDisabled",!1))).catch(o.popupAjaxError).finally((()=>this.set("loading",!1)))}static#t=(()=>dt7948.n(this.prototype,"enableHoliday",[s.action]))()},[(0,i.classNameBindings)("isHolidayDisabled:disabled"),(0,i.tagName)("tr")])
e.default=(0,t.setComponentTemplate)(a,d)})),define("discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,i.createTemplateFactory)({id:"95/VMUcJ",block:'[[[10,"table"],[14,0,"holidays-list"],[12],[1,"\\n  "],[10,"thead"],[12],[1,"\\n    "],[10,"tr"],[12],[1,"\\n      "],[10,"td"],[12],[1,[28,[35,4],["discourse_calendar.date"],null]],[13],[1,"\\n      "],[10,"td"],[14,"colspan","2"],[12],[1,[28,[35,4],["discourse_calendar.holiday"],null]],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,"tbody"],[12],[1,"\\n"],[42,[28,[37,7],[[28,[37,7],[[30,1]],null]],null],null,[[[1,"      "],[8,[39,8],null,[["@holiday","@isHolidayDisabled","@region_code"],[[30,2],[30,2,["disabled"]],[30,3]]],null],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"],[13]],["@holidays","holiday","@region_code"],false,["table","thead","tr","td","i18n","tbody","each","-track-array","admin-holidays-list-item"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(n,(0,s.default)(void 0,"admin-holidays-list"))})),define("discourse/plugins/discourse-calendar/discourse/components/bulk-invite-sample-csv-file",["exports","@ember/component","@ember/object","@ember/template-factory"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,i.createTemplateFactory)({id:"k9x9DF/w",block:'[[[8,[39,0],null,[["@label","@action"],["discourse_post_event.bulk_invite_modal.download_sample_csv",[28,[37,1],[[30,0],"downloadSampleCsv"],null]]],null]],[],false,["d-button","action"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/components/bulk-invite-sample-csv-file.hbs",isStrictMode:!1})
class o extends t.default{downloadSampleCsv(){let e="";[["my_awesome_group","going"],["lucy","interested"],["mark","not_going"],["sam","unknown"]].forEach((t=>{e+=t.join(","),e+="\n"}))
const t=document.createElement("a")
t.href=`data:text/csv;charset=utf-8,${encodeURI(e)}`,t.target="_blank",t.rel="noopener noreferrer",t.download="bulk-invite-sample.csv",t.click()}static#e=(()=>dt7948.n(this.prototype,"downloadSampleCsv",[s.action]))()}e.default=o,(0,t.setComponentTemplate)(n,o)})),define("discourse/plugins/discourse-calendar/discourse/components/csv-uploader",["exports","@glimmer/component","@ember/owner","@ember/render-modifiers/modifiers/did-insert","@ember/service","truth-helpers","discourse/helpers/d-icon","discourse/lib/uppy/uppy-upload","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"dialog",[n.service]))()
#s=(()=>{dt7948.i(this,"dialog")})()
uppyUpload=(()=>new a.default((0,s.getOwner)(this),{type:"csv",id:"discourse-post-event-csv-uploader",autoStartUploads:!1,uploadUrl:this.args.uploadUrl,uppyReady:()=>{this.uppyUpload.uppyWrapper.uppyInstance.on("file-added",(()=>{this.dialog.confirm({message:(0,d.i18n)(`${this.args.i18nPrefix}.confirmation_message`),didConfirm:()=>this.uppyUpload.startUpload(),didCancel:()=>this.uppyUpload.reset()})}))},uploadDone:()=>{this.dialog.alert((0,d.i18n)(`${this.args.i18nPrefix}.success`))},validateUploadedFilesOptions:{csvOnly:!0}}))()
get uploadButtonText(){return this.uppyUpload.uploading?(0,d.i18n)("uploading"):(0,d.i18n)(`${this.args.i18nPrefix}.text`)}get uploadButtonDisabled(){return this.uppyUpload.uploading||this.uppyUpload.processing||null}static#t=(()=>(0,l.setComponentTemplate)((0,u.createTemplateFactory)({id:"ZKr+v75I",block:'[[[1,"\\n    "],[10,1],[12],[1,"\\n      "],[10,"label"],[14,0,"btn"],[15,"disabled",[30,0,["uploadButtonDisabled"]]],[12],[1,"\\n        "],[1,[28,[32,0],["upload"],null]],[1," "],[1,[30,0,["uploadButtonText"]]],[1,"\\n        "],[11,"input"],[24,0,"hidden-upload-field"],[16,"disabled",[30,0,["uppyUpload","uploading"]]],[24,"accept",".csv"],[24,4,"file"],[4,[32,1],[[30,0,["uppyUpload","setup"]]],null],[12],[13],[1,"\\n      "],[13],[1,"\\n"],[41,[28,[32,2],[[30,0,["uppyUpload","uploading"]],[30,0,["uppyUpload","processing"]]],null],[[[1,"        "],[10,1],[12],[1,[28,[32,3],["upload_selector.uploading"],null]],[1,"\\n          "],[1,[30,0,["uppyUpload","uploadProgress"]]],[1,"%"],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/csv-uploader.js",scope:()=>[r.default,i.default,o.or,d.i18n],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator",["exports","@glimmer/component","discourse/helpers/avatar","discourse/lib/utilities","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{get username(){return this.args.user.name||(0,i.formatUsername)(this.args.user.username)}static#e=(()=>(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"xp4ZBM+r",block:'[[[1,"\\n    "],[10,1],[14,0,"creators"],[12],[1,"\\n      "],[10,1],[14,0,"created-by"],[12],[1,[28,[32,0],["discourse_post_event.created_by"],null]],[13],[1,"\\n\\n      "],[10,1],[14,0,"event-creator"],[12],[1,"\\n        "],[10,3],[14,0,"topic-invitee-avatar"],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n          "],[1,[28,[32,1],[[30,1]],[["imageSize"],["tiny"]]]],[1,"\\n          "],[10,1],[14,0,"username"],[12],[1,[30,0,["username"]]],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@user"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator.js",scope:()=>[n.i18n,s.default],isStrictMode:!0}),this))()}e.default=a})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/runloop","@ember/service","@ember/template","discourse/helpers/d-icon","discourse/lib/local-dates","discourse/lib/text","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u,c,p,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class v extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[r.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#t=(()=>dt7948.g(this.prototype,"htmlDates",[s.tracked],(function(){return""})))()
#n=(()=>{dt7948.i(this,"htmlDates")})()
get startsAt(){return moment(this.args.event.startsAt).tz(this.timezone)}get endsAt(){return this.args.event.endsAt&&moment(this.args.event.endsAt).tz(this.timezone)}get timezone(){return this.args.event.timezone||"UTC"}get format(){return(0,c.default)(this.startsAt,this.endsAt)}get datesBBCode(){const e=[]
return e.push(`[date=${this.startsAt.format("YYYY-MM-DD")} time=${this.startsAt.format("HH:mm")} format=${this.format} timezone=${this.timezone}]`),this.endsAt&&e.push(`[date=${this.endsAt.format("YYYY-MM-DD")} time=${this.endsAt.format("HH:mm")} format=${this.format} timezone=${this.timezone}]`),e}async computeDates(e){if(this.siteSettings.discourse_local_dates_enabled){const t=await(0,u.cook)(this.datesBBCode.join("<span> → </span>"))
this.htmlDates=(0,a.htmlSafe)(t.toString()),(0,o.next)((()=>{this.isDestroying||this.isDestroyed||(0,l.applyLocalDates)(e.querySelectorAll(`[data-post-id="${this.args.event.id}"] .discourse-local-date`),this.siteSettings)}))}else{let e=`${this.startsAt.format(this.format)}`
this.endsAt&&(e+=` → ${moment(this.endsAt).format(this.format)}`),this.htmlDates=(0,a.htmlSafe)(e)}}static#o=(()=>dt7948.n(this.prototype,"computeDates",[i.action]))()
static#r=(()=>(0,p.setComponentTemplate)((0,m.createTemplateFactory)({id:"M8tS1M4H",block:'[[[1,"\\n    "],[11,"section"],[24,0,"event__section event-dates"],[4,[32,0],[[30,0,["computeDates"]]],null],[12],[1,"\\n      "],[1,[28,[32,1],["clock"],null]],[1,[30,0,["htmlDates"]]],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates.js",scope:()=>[n.default,d.default],isStrictMode:!0}),this))()}e.default=v})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status",["exports","@glimmer/component","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get eventStatusLabel(){return(0,s.i18n)(`discourse_post_event.models.event.status.${this.args.event.status}.title`)}get eventStatusDescription(){return(0,s.i18n)(`discourse_post_event.models.event.status.${this.args.event.status}.description`)}get statusClass(){return`status ${this.args.event.status}`}static#e=(()=>(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"Mp6je1A1",block:'[[[1,"\\n"],[41,[30,1,["isExpired"]],[[[1,"      "],[10,1],[14,0,"status expired"],[12],[1,"\\n        "],[1,[28,[32,0],["discourse_post_event.models.event.expired"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isClosed"]],[[[1,"      "],[10,1],[14,0,"status closed"],[12],[1,"\\n        "],[1,[28,[32,0],["discourse_post_event.models.event.closed"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,1],[15,0,[30,0,["statusClass"]]],[15,"title",[30,0,["eventStatusDescription"]]],[12],[1,"\\n        "],[1,[30,0,["eventStatusLabel"]]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]],[]]],[1,"  "]],["@event"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status.js",scope:()=>[s.i18n],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index",["exports","@glimmer/component","@ember/helper","@ember/service","ember-modifier","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse/helpers/d-icon","discourse/helpers/replace-emoji","discourse/helpers/route-action","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i,n,o,r,a,d,l,u,c,p,m,v,g,h,f,_,b){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const y=(0,f.setComponentTemplate)((0,_.createTemplateFactory)({id:"O0UTLdC7",block:'[[[1,"\\n  "],[10,1],[14,0,"separator"],[12],[1,"·"],[13],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",isStrictMode:!0}),(0,b.default)(void 0,"discourse-post-event:StatusSeparator")),w=(0,f.setComponentTemplate)((0,_.createTemplateFactory)({id:"NByHOHeM",block:'[[[1,"\\n  "],[11,"section"],[24,0,"event__section"],[17,1],[12],[1,"\\n"],[41,[30,2],[[[1,"      "],[1,[28,[32,0],[[30,2]],null]],[1,"\\n"]],[]],null],[1,"\\n    "],[18,3,null],[1,"\\n  "],[13],[1,"\\n"]],["&attrs","@icon","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",scope:()=>[a.default],isStrictMode:!0}),(0,b.default)(void 0,"discourse-post-event:InfoSection"))
class A extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[i.service]))()
#a=(()=>{dt7948.i(this,"currentUser")})()
static#t=(()=>dt7948.g(this.prototype,"discoursePostEventApi",[i.service]))()
#d=(()=>{dt7948.i(this,"discoursePostEventApi")})()
static#o=(()=>dt7948.g(this.prototype,"messageBus",[i.service]))()
#l=(()=>{dt7948.i(this,"messageBus")})()
setupMessageBus=(()=>(0,n.modifier)((()=>{const{event:e}=this.args,t=`/discourse-post-event/${e.post.topic.id}`
return this.messageBus.subscribe(t,(async t=>{const s=await this.discoursePostEventApi.event(t.id)
e.updateFromEvent(s)})),()=>this.messageBus.unsubscribe(t)})))()
get startsAtMonth(){return moment(this.args.event.startsAt).format("MMM")}get startsAtDay(){return moment(this.args.event.startsAt).format("D")}get eventName(){return this.args.event.name||this.args.event.post.topic.title}get isPublicEvent(){return"public"===this.args.event.status}get isStandaloneEvent(){return"standalone"===this.args.event.status}get canActOnEvent(){return this.currentUser&&this.args.event.can_act_on_discourse_post_event}get watchingInviteeStatus(){return this.args.event.watchingInvitee?.status}static#r=(()=>(0,f.setComponentTemplate)((0,_.createTemplateFactory)({id:"TiZm3tSc",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["discourse-post-event",[52,[30,1],"is-loaded","is-loading"]],null]],[12],[1,"\\n      "],[10,0],[14,0,"discourse-post-event-widget"],[12],[1,"\\n"],[41,[30,1],[[[1,"          "],[11,"header"],[24,0,"event-header"],[4,[30,0,["setupMessageBus"]],null,null],[12],[1,"\\n            "],[10,0],[14,0,"event-date"],[12],[1,"\\n              "],[10,0],[14,0,"month"],[12],[1,[30,0,["startsAtMonth"]]],[13],[1,"\\n              "],[10,0],[14,0,"day"],[12],[1,[30,0,["startsAtDay"]]],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,0],[14,0,"event-info"],[12],[1,"\\n              "],[10,1],[14,0,"name"],[12],[1,"\\n                "],[1,[28,[32,1],[[30,0,["eventName"]]],null]],[1,"\\n              "],[13],[1,"\\n              "],[10,0],[14,0,"status-and-creators"],[12],[1,"\\n                "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-and-creators",[28,[32,3],null,[["event","Separator","Status","Creator"],[[30,1],[32,4],[50,[32,5],0,null,[["event"],[[30,1]]]],[50,[32,6],0,null,[["user"],[[30,1,["creator"]]]]]]]]]],[["default"],[[[[1,"\\n                  "],[8,[32,5],null,[["@event"],[[30,1]]],null],[1,"\\n                  "],[8,[32,4],null,null,null],[1,"\\n                  "],[8,[32,6],null,[["@user"],[[30,1,["creator"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n\\n            "],[8,[32,7],null,[["@event","@isStandaloneEvent","@composePrivateMessage"],[[30,1],[30,0,["isStandaloneEvent"]],[28,[32,8],["composePrivateMessage"],null]]],null],[1,"\\n          "],[13],[1,"\\n\\n          "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-info",[28,[32,3],null,[["event","Section","Url","Dates","Invitees","Status"],[[30,1],[50,[32,9],0,null,[["event"],[[30,1]]]],[50,[32,10],0,null,[["url"],[[30,1,["url"]]]]],[50,[32,11],0,null,[["event"],[[30,1]]]],[50,[32,12],0,null,[["event"],[[30,1]]]],[50,[32,13],0,null,[["event"],[[30,1]]]]]]]]],[["default"],[[[[1,"\\n            "],[8,[32,10],null,[["@url"],[[30,1,["url"]]]],null],[1,"\\n            "],[8,[32,11],null,[["@event"],[[30,1]]],null],[1,"\\n            "],[8,[32,12],null,[["@event"],[[30,1]]],null],[1,"\\n"],[41,[30,1,["canUpdateAttendance"]],[[[1,"              "],[8,[32,13],null,[["@event"],[[30,1]]],null],[1,"\\n"]],[]],null],[1,"          "]],[]]]]],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@event"],false,["if","component"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",scope:()=>[r.default,d.default,o.default,s.hash,y,p.default,u.default,v.default,l.default,w,h.default,c.default,m.default,g.default],isStrictMode:!0}),this))()}e.default=A})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee",["exports","@glimmer/component","@ember/helper","@ember/service","truth-helpers","discourse/components/avatar-flair","discourse/helpers/avatar","discourse/helpers/concat-class","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[i.service]))()
#u=(()=>{dt7948.i(this,"site")})()
static#t=(()=>dt7948.g(this.prototype,"currentUser",[i.service]))()
#a=(()=>{dt7948.i(this,"currentUser")})()
get statusIcon(){switch(this.args.invitee.status){case"going":return"check"
case"interested":return"star"
case"not_going":return"xmark"}}get flairName(){const e=`discourse_post_event.models.invitee.status.${this.args.invitee.status}`
return(0,d.i18n)(e)}static#o=(()=>(0,l.setComponentTemplate)((0,u.createTemplateFactory)({id:"XZIgZYiv",block:'[[[1,"\\n    "],[10,"li"],[15,0,[28,[32,0],["event-invitee",[52,[30,1,["status"]],[28,[32,1],["status-",[30,1,["status"]]],null]],[52,[28,[32,2],[[30,0,["currentUser","id"]],[30,1,["user","id"]]],null],"is-current-user"]],null]],[12],[1,"\\n      "],[10,3],[14,0,"topic-invitee-avatar"],[15,"data-user-card",[30,1,["user","username"]]],[12],[1,"\\n        "],[1,[28,[32,3],[[30,1,["user"]]],[["imageSize"],[[52,[30,0,["site","mobileView"]],"tiny","large"]]]]],[1,"\\n"],[41,[30,0,["statusIcon"]],[[[1,"          "],[8,[32,4],null,[["@flairName","@flairUrl"],[[30,0,["flairName"]],[30,0,["statusIcon"]]]],null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@invitee"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee.js",scope:()=>[a.default,s.concat,n.eq,r.default,o.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees",["exports","@glimmer/component","@ember/service","discourse/helpers/d-icon","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"modal",[s.service]))()
#c=(()=>{dt7948.i(this,"modal")})()
static#t=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
get hasAttendees(){return this.args.event.stats.going>0}get statsInfo(){return this.args.event.stats.going}get inviteesTitle(){return(0,n.i18n)("discourse_post_event.models.invitee.status.going_count",{count:this.args.event.stats.going})}static#o=(()=>(0,r.setComponentTemplate)((0,a.createTemplateFactory)({id:"m+nhmxYx",block:'[[[1,"\\n"],[41,[51,[30,1,["minimal"]]],[[[41,[30,1,["shouldDisplayInvitees"]],[[[1,"        "],[10,"section"],[14,0,"event__section event-invitees"],[12],[1,"\\n          "],[10,0],[14,0,"event-invitees-avatars-container"],[12],[1,"\\n            "],[10,0],[14,0,"event-invitees-icon"],[15,"title",[30,0,["inviteesTitle"]]],[12],[1,"\\n              "],[1,[28,[32,0],["users"],null]],[1,"\\n"],[41,[30,0,["hasAttendees"]],[[[1,"                "],[10,1],[14,0,"going"],[12],[1,[30,0,["statsInfo"]]],[13],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n            "],[10,"ul"],[14,0,"event-invitees-avatars"],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,1,["sampleInvitees"]]],null]],null],null,[[[1,"                "],[8,[32,1],null,[["@invitee"],[[30,2]]],null],[1,"\\n"]],[2]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[51,[30,1,["isStandalone"]]],[[[1,"          "],[10,"section"],[14,0,"event__section event-invitees no-rsvp"],[12],[1,"\\n            "],[10,2],[14,0,"no-rsvp-description"],[12],[1,[28,[32,2],["discourse_post_event.models.invitee.status.going_count.other"],[["count"],["0"]]]],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null]],[]]]],[]],null],[1,"  "]],["@event","invitee"],false,["unless","if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees.js",scope:()=>[i.default,o.default,n.i18n],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu",["exports","@glimmer/component","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/dropdown-menu","discourse/lib/ajax-error","discourse/lib/download-calendar","discourse/lib/export-csv","discourse/lib/get-url","discourse/lib/text","discourse/lib/transformer","discourse-i18n","float-kit/components/d-menu","discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u,c,p,m,v,g,h,f,_,b,y,w){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class A extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[n.service]))()
#a=(()=>{dt7948.i(this,"currentUser")})()
static#t=(()=>dt7948.g(this.prototype,"dialog",[n.service]))()
#s=(()=>{dt7948.i(this,"dialog")})()
static#o=(()=>dt7948.g(this.prototype,"discoursePostEventApi",[n.service]))()
#d=(()=>{dt7948.i(this,"discoursePostEventApi")})()
static#r=(()=>dt7948.g(this.prototype,"modal",[n.service]))()
#c=(()=>{dt7948.i(this,"modal")})()
static#p=(()=>dt7948.g(this.prototype,"router",[n.service]))()
#m=(()=>{dt7948.i(this,"router")})()
static#v=(()=>dt7948.g(this.prototype,"siteSettings",[n.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#g=(()=>dt7948.g(this.prototype,"store",[n.service]))()
#h=(()=>{dt7948.i(this,"store")})()
get expiredOrClosed(){return this.args.event.isExpired||this.args.event.isClosed}get canActOnEvent(){return this.currentUser&&this.args.event.canActOnDiscoursePostEvent}get shouldShowParticipants(){return(0,p.applyValueTransformer)("discourse-calendar-event-more-menu-should-show-participants",this.canActOnEvent&&!this.args.isStandaloneEvent,{event:this.args.event})}get canInvite(){return!this.expiredOrClosed&&this.canActOnEvent&&this.args.event.isPublic}get canSeeUpcomingEvents(){return!this.args.event.isClosed&&this.args.event.recurrence}get canBulkInvite(){return!this.expiredOrClosed&&!this.args.event.isStandalone}get canSendPmToCreator(){return this.currentUser&&this.currentUser.username!==this.args.event.creator.username}addToCalendar(){this.menuApi.close()
const e=this.args.event;(0,d.downloadCalendar)(e.name||e.post.topic.title,[{startsAt:e.startsAt,endsAt:e.endsAt}],{recurrenceRule:e.recurrenceRule,location:e.url,details:(0,u.getAbsoluteURL)(e.post.url)})}static#f=(()=>dt7948.n(this.prototype,"addToCalendar",[i.action]))()
sendPMToCreator(){this.menuApi.close(),this.args.composePrivateMessage(i.default.create(this.args.event.creator),i.default.create(this.args.event.post))}static#_=(()=>dt7948.n(this.prototype,"sendPMToCreator",[i.action]))()
upcomingEvents(){this.router.transitionTo("discourse-post-event-upcoming-events")}static#b=(()=>dt7948.n(this.prototype,"upcomingEvents",[i.action]))()
registerMenuApi(e){this.menuApi=e}static#y=(()=>dt7948.n(this.prototype,"registerMenuApi",[i.action]))()
async inviteUserOrGroup(){this.menuApi.close()
try{this.modal.show(_.default,{model:{event:this.args.event}})}catch(e){(0,a.popupAjaxError)(e)}}static#w=(()=>dt7948.n(this.prototype,"inviteUserOrGroup",[i.action]))()
exportPostEvent(){this.menuApi.close(),(0,l.exportEntity)("post_event",{name:"post_event",id:this.args.event.id})}static#A=(()=>dt7948.n(this.prototype,"exportPostEvent",[i.action]))()
bulkInvite(){this.menuApi.close(),this.modal.show(f.default,{model:{event:this.args.event}})}static#k=(()=>dt7948.n(this.prototype,"bulkInvite",[i.action]))()
async openEvent(){this.menuApi.close(),this.dialog.yesNoConfirm({message:(0,m.i18n)("discourse_post_event.builder_modal.confirm_open"),didConfirm:async()=>{try{const e=await this.store.find("post",this.args.event.id)
this.args.event.isClosed=!1
const t=(0,g.buildParams)(this.args.event.startsAt,this.args.event.endsAt,this.args.event,this.siteSettings),s=(0,g.replaceRaw)(t,e.raw)
if(s){const t={raw:s,edit_reason:(0,m.i18n)("discourse_post_event.edit_reason_opened")},i=await(0,c.cook)(s)
t.cooked=i.string,await e.save(t)}}catch(e){(0,a.popupAjaxError)(e)}}})}static#E=(()=>dt7948.n(this.prototype,"openEvent",[i.action]))()
async editPostEvent(){this.menuApi.close(),this.modal.show(h.default,{model:{event:this.args.event}})}static#x=(()=>dt7948.n(this.prototype,"editPostEvent",[i.action]))()
showParticipants(){this.menuApi.close(),this.modal.show(b.default,{model:{event:this.args.event,title:this.args.event.title,extraClass:this.args.event.extraClass}})}static#M=(()=>dt7948.n(this.prototype,"showParticipants",[i.action]))()
async closeEvent(){this.menuApi.close(),this.dialog.yesNoConfirm({message:(0,m.i18n)("discourse_post_event.builder_modal.confirm_close"),didConfirm:()=>this.store.find("post",this.args.event.id).then((e=>{this.args.event.isClosed=!0
const t=(0,g.buildParams)(this.args.event.startsAt,this.args.event.endsAt,this.args.event,this.siteSettings),s=(0,g.replaceRaw)(t,e.raw)
if(s){const t={raw:s,edit_reason:(0,m.i18n)("discourse_post_event.edit_reason_closed")}
return(0,c.cook)(s).then((s=>(t.cooked=s.string,e.save(t))))}}))})}static#z=(()=>dt7948.n(this.prototype,"closeEvent",[i.action]))()
static#S=(()=>(0,y.setComponentTemplate)((0,w.createTemplateFactory)({id:"gZtYm34P",block:'[[[1,"\\n    "],[8,[32,0],null,[["@identifier","@triggerClass","@icon","@onRegisterApi"],["discourse-post-event-more-menu","more-dropdown","ellipsis",[30,0,["registerMenuApi"]]]],[["content"],[[[[1,"\\n        "],[8,[32,1],null,null,[["default"],[[[[1,"\\n"],[41,[51,[30,0,["expiredOrClosed"]]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"add-to-calendar"]],null,[["default"],[[[[1,"\\n              "],[8,[32,2],null,[["@icon","@label","@action"],["file","discourse_post_event.add_to_calendar",[30,0,["addToCalendar"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canSendPmToCreator"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"send-pm-to-creator"]],null,[["default"],[[[[1,"\\n              "],[8,[32,2],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["envelope",[28,[32,3],["discourse_post_event.send_pm_to_creator",[28,[32,4],null,[["username"],[[30,2,["creator","username"]]]]]],null],[30,0,["sendPMToCreator"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canInvite"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"invite-user-or-group"]],null,[["default"],[[[[1,"\\n              "],[8,[32,2],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["user-plus",[28,[32,3],["discourse_post_event.invite"],null],[30,0,["inviteUserOrGroup"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canSeeUpcomingEvents"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"upcoming-events"]],null,[["default"],[[[[1,"\\n              "],[8,[32,2],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["far-calendar-plus",[28,[32,3],["discourse_post_event.upcoming_events.title"],null],[30,0,["upcomingEvents"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldShowParticipants"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"show-all-participants"]],null,[["default"],[[[[1,"\\n              "],[8,[32,2],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["user-group","discourse_post_event.show_participants",[30,0,["showParticipants"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n\\n            "],[8,[30,1,["divider"]],null,null,null],[1,"\\n"]],[]],null],[41,[30,0,["canActOnEvent"]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"export-event"]],null,[["default"],[[[[1,"\\n              "],[8,[32,2],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["file-csv","discourse_post_event.export_event",[30,0,["exportPostEvent"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["canBulkInvite"]],[[[1,"              "],[8,[30,1,["item"]],[[24,0,"bulk-invite"]],null,[["default"],[[[[1,"\\n                "],[8,[32,2],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["file-arrow-up","discourse_post_event.bulk_invite",[30,0,["bulkInvite"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,2,["isClosed"]],[[[1,"              "],[8,[30,1,["item"]],[[24,0,"open-event"]],null,[["default"],[[[[1,"\\n                "],[8,[32,2],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["unlock","discourse_post_event.open_event",[30,0,["openEvent"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n"]],[]],[[[1,"              "],[8,[30,1,["item"]],[[24,0,"edit-event"]],null,[["default"],[[[[1,"\\n                "],[8,[32,2],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["pencil","discourse_post_event.edit_event",[30,0,["editPostEvent"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n"],[41,[51,[30,2,["isExpired"]]],[[[1,"                "],[8,[30,1,["item"]],[[24,0,"close-event"]],null,[["default"],[[[[1,"\\n                  "],[8,[32,2],[[24,0,"btn-transparent btn-danger"]],[["@icon","@label","@action"],["xmark","discourse_post_event.close_event",[30,0,["closeEvent"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null]],[]]]],[]],null],[1,"        "]],[1]]]]],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["dropdown","@event"],false,["unless","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu.js",scope:()=>[v.default,r.default,o.default,m.i18n,s.hash],isStrictMode:!0}),this))()}e.default=A})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status",["exports","@glimmer/component","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse/lib/ajax-error","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"appEvents",[n.service]))()
#P=(()=>{dt7948.i(this,"appEvents")})()
static#t=(()=>dt7948.g(this.prototype,"discoursePostEventApi",[n.service]))()
#d=(()=>{dt7948.i(this,"discoursePostEventApi")})()
static#o=(()=>dt7948.g(this.prototype,"siteSettings",[n.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
get eventButtons(){return this.siteSettings.event_participation_buttons.split("|")}get showGoingButton(){return!!this.eventButtons.find((e=>"going"===e))}get showInterestedButton(){return!!this.eventButtons.find((e=>"interested"===e))}get showNotGoingButton(){return!!this.eventButtons.find((e=>"not going"===e))}get canLeave(){return this.args.event.watchingInvitee&&this.args.event.isPublic}get watchingInviteeStatus(){return this.args.event.watchingInvitee?.status}async leaveEvent(){try{const e=this.args.event.watchingInvitee
await this.discoursePostEventApi.leaveEvent(this.args.event,e),this.appEvents.trigger("calendar:invitee-left-event",{invitee:e,postId:this.args.event.id})}catch(e){(0,d.popupAjaxError)(e)}}static#r=(()=>dt7948.n(this.prototype,"leaveEvent",[i.action]))()
async updateEventAttendance(e){try{await this.discoursePostEventApi.updateEventAttendance(this.args.event,{status:e}),this.appEvents.trigger("calendar:update-invitee-status",{status:e,postId:this.args.event.id})}catch(t){(0,d.popupAjaxError)(t)}}static#p=(()=>dt7948.n(this.prototype,"updateEventAttendance",[i.action]))()
async joinEventWithStatus(e){try{await this.discoursePostEventApi.joinEvent(this.args.event,{status:e}),this.appEvents.trigger("calendar:create-invitee-status",{status:e,postId:this.args.event.id})}catch(t){(0,d.popupAjaxError)(t)}}static#v=(()=>dt7948.n(this.prototype,"joinEventWithStatus",[i.action]))()
async changeWatchingInviteeStatus(e){if(this.args.event.watchingInvitee){const t=this.args.event.watchingInvitee.status
this.canLeave?e===t?await this.leaveEvent():await this.updateEventAttendance(e):(e===t&&(e=null),await this.updateEventAttendance(e))}else await this.joinEventWithStatus(e)}static#g=(()=>dt7948.n(this.prototype,"changeWatchingInviteeStatus",[i.action]))()
static#f=(()=>(0,l.setComponentTemplate)((0,u.createTemplateFactory)({id:"94m0svTq",block:'[[[1,"\\n    "],[10,"section"],[15,0,[28,[32,0],["event__section event-actions event-status",[52,[30,0,["watchingInviteeStatus"]],[28,[32,1],["status-",[30,0,["watchingInviteeStatus"]]],null]]],null]],[12],[1,"\\n      "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-buttons",[28,[32,3],null,[["event"],[[30,1]]]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["showGoingButton"]],[[[41,[51,[30,1,["minimal"]]],[[[1,"            "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-going-button",[28,[32,3],null,[["event","markAsGoing"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"going"],null]]]]]],[["default"],[[[[1,"\\n              "],[8,[32,5],[[24,0,"going-button"]],[["@icon","@label","@action"],["check","discourse_post_event.models.invitee.status.going",[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"going"],null]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null]],[]],null],[1,"\\n"],[41,[30,0,["showInterestedButton"]],[[[1,"          "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-interested-button",[28,[32,3],null,[["event","markAsInterested"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"interested"],null]]]]]],[["default"],[[[[1,"\\n            "],[8,[32,5],[[24,0,"interested-button"]],[["@icon","@label","@action"],["star","discourse_post_event.models.invitee.status.interested",[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"interested"],null]]],null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showNotGoingButton"]],[[[41,[51,[30,1,["minimal"]]],[[[1,"            "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-not-going-button",[28,[32,3],null,[["event","markAsNotGoing"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"not_going"],null]]]]]],[["default"],[[[[1,"\\n              "],[8,[32,5],[[24,0,"not-going-button"]],[["@icon","@label","@action"],["xmark","discourse_post_event.models.invitee.status.not_going",[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"not_going"],null]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null]],[]],null],[1,"      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],["@event"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status.js",scope:()=>[a.default,s.concat,r.default,s.hash,s.fn,o.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url",["exports","@glimmer/component","discourse/helpers/d-icon","@ember/component","@ember/template-factory"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get url(){return this.args.url.includes("://")||this.args.url.includes("mailto:")?this.args.url:`https://${this.args.url}`}static#e=(()=>(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"F+RqQwEg",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,"section"],[14,0,"event__section event-url"],[12],[1,"\\n        "],[1,[28,[32,0],["link"],null]],[1,"\\n        "],[10,3],[14,0,"url"],[15,6,[30,0,["url"]]],[14,"target","_blank"],[14,"rel","noopener noreferrer"],[12],[1,"\\n          "],[1,[30,1]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@url"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url.js",scope:()=>[s.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/discourse-calendar/discourse/components/event-date",["exports","@glimmer/component","@ember/service","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#t=(()=>(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"RjIMaT3A",block:'[[[41,[30,0,["shouldRender"]],[[[10,1],[14,0,"header-topic-title-suffix-outlet event-date-container"],[12],[41,[30,0,["siteSettings","use_local_event_date"]],[[[10,1],[14,0,"event-date event-local-date past"],[15,"title",[30,0,["dateRange"]]],[15,"data-starts-at",[30,0,["eventStartedAt"]]],[15,"data-ends-at",[30,0,["eventEndedAt"]]],[12],[1,"\\n            "],[1,[30,0,["localDateContent"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,1],[15,0,[29,["event-date event-relative-date ",[30,0,["relativeDateType"]]]]],[15,"title",[30,0,["dateRange"]]],[15,"data-starts-at",[30,0,["eventStartedAt"]]],[15,"data-ends-at",[30,0,["eventEndedAt"]]],[12],[41,[30,0,["isWithinDateRange"]],[[[10,1],[14,0,"indicator"],[12],[13],[1,"\\n              "],[10,1],[14,0,"text"],[12],[1,[30,0,["timeRemainingContent"]]],[13],[1,"\\n"]],[]],[[[1,"              "],[1,[30,0,["relativeDateContent"]]]],[]]],[13]],[]]],[13]],[]],null]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/event-date.js",isStrictMode:!0}),this))()
get shouldRender(){return this.siteSettings.discourse_post_event_enabled&&this.args.topic.event_starts_at}get eventStartedAt(){return this._parsedDate(this.args.topic.event_starts_at)}get eventEndedAt(){return this.args.topic.event_ends_at?this._parsedDate(this.args.topic.event_ends_at):this.eventStartedAt}get dateRange(){return this.args.topic.event_ends_at?`${this._formattedDate(this.eventStartedAt)} → ${this._formattedDate(this.eventEndedAt)}`:this._formattedDate(this.eventStartedAt)}get localDateContent(){return this._formattedDate(this.eventStartedAt)}get relativeDateType(){return this.isWithinDateRange?"current":this.eventStartedAt.isAfter(moment())?"future":"past"}get isWithinDateRange(){return this.eventStartedAt.isBefore(moment())&&this.eventEndedAt.isAfter(moment())}get relativeDateContent(){return{future:this.eventStartedAt.from(moment()),past:this.eventEndedAt.from(moment())}[this.relativeDateType]}get timeRemainingContent(){return(0,i.i18n)("discourse_post_event.topic_title.ends_in_duration",{duration:this.eventEndedAt.from(moment())})}_parsedDate(e){return moment.utc(e).tz(moment.tz.guess())}_guessedDateFormat(){return(0,n.default)(this.eventStartedAt)}_formattedDate(e){return e.format(this._guessedDateFormat())}}e.default=a})),define("discourse/plugins/discourse-calendar/discourse/components/event-field",["exports","discourse-i18n","truth-helpers/helpers/not-eq","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"5EUfCPdK",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,1],false],null],[[[1,"    "],[11,0],[24,0,"event-field"],[17,2],[12],[1,"\\n"],[41,[30,3],[[[1,"        "],[10,0],[14,0,"event-field-label"],[12],[1,"\\n          "],[10,1],[14,0,"label"],[12],[1,[28,[32,1],[[30,3]],null]],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"event-field-control"],[12],[1,"\\n        "],[18,4,null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null]],["@enabled","&attrs","@label","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/event-field.js",scope:()=>[s.default,t.i18n],isStrictMode:!0}),(0,o.default)(void 0,"event-field:EventField"))
e.default=r})),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","discourse/lib/text","discourse/models/group","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,c.createTemplateFactory)({id:"0V/s0ims",block:'[[[8,[39,0],[[24,0,"post-event-builder-modal"]],[["@title","@closeModal","@flash"],[[28,[37,1],[[28,[37,2],["discourse_post_event.builder_modal.",[52,[30,1,["event","id"]],"update_event_title","create_event_title"]],null]],null],[30,2],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[8,[39,5],null,[["@isLoading"],[[30,0,["isSaving"]]]],[["default"],[[[[1,"\\n      "],[10,"form"],[12],[1,"\\n        "],[8,[39,7],null,[["@name","@outletArgs","@connectorTagName"],["post-event-builder-form",[28,[37,8],null,[["event"],[[30,1,["event"]]]]],"div"]],[["default"],[[[[1,"\\n          "],[8,[39,9],null,[["@from","@to","@timezone","@onChange"],[[30,0,["startsAt"]],[30,0,["endsAt"]],[30,1,["event","timezone"]],[30,0,["onChangeDates"]]]],null],[1,"\\n\\n          "],[8,[39,10],[[24,0,"name"]],[["@label"],["discourse_post_event.builder_modal.name.label"]],[["default"],[[[[1,"\\n            "],[8,[39,11],[[16,"placeholder",[28,[37,1],["discourse_post_event.builder_modal.name.placeholder"],null]]],[["@value"],[[30,1,["event","name"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[39,10],[[24,0,"url"]],[["@label"],["discourse_post_event.builder_modal.url.label"]],[["default"],[[[[1,"\\n            "],[8,[39,11],[[16,"placeholder",[28,[37,1],["discourse_post_event.builder_modal.url.placeholder"],null]]],[["@value"],[[30,1,["event","url"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[39,10],[[24,0,"timezone"]],[["@label"],["discourse_post_event.builder_modal.timezone.label"]],[["default"],[[[[1,"\\n            "],[8,[39,12],[[24,0,"input-xxlarge"]],[["@value","@onChange","@none"],[[30,1,["event","timezone"]],[30,0,["setNewTimezone"]],"discourse_post_event.builder_modal.timezone.remove_timezone"]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[39,10],null,[["@label"],["discourse_post_event.builder_modal.status.label"]],[["default"],[[[[1,"\\n            "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n              "],[8,[39,14],null,[["@name","@value","@selection","@onChange"],["status","public",[30,1,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[10,1],[14,0,"title"],[12],[1,"\\n                  "],[1,[28,[35,1],["discourse_post_event.models.event.status.public.title"],null]],[1,"\\n                "],[13],[1,"\\n                "],[10,1],[14,0,"description"],[12],[1,"\\n                  "],[1,[28,[35,1],["discourse_post_event.models.event.status.public.description"],null]],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n              "],[8,[39,14],null,[["@name","@value","@selection","@onChange"],["status","private",[30,1,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[10,1],[14,0,"title"],[12],[1,"\\n                  "],[1,[28,[35,1],["discourse_post_event.models.event.status.private.title"],null]],[1,"\\n                "],[13],[1,"\\n                "],[10,1],[14,0,"description"],[12],[1,"\\n                  "],[1,[28,[35,1],["discourse_post_event.models.event.status.private.description"],null]],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n              "],[8,[39,14],null,[["@name","@value","@selection","@onChange"],["status","standalone",[30,1,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[10,1],[14,0,"title"],[12],[1,"\\n                  "],[1,[28,[35,1],["discourse_post_event.models.event.status.standalone.title"],null]],[1,"\\n                "],[13],[1,"\\n                "],[10,1],[14,0,"description"],[12],[1,"\\n                  "],[1,[28,[35,1],["discourse_post_event.models.event.status.standalone.description"],null]],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[39,10],null,[["@enabled","@label"],[[28,[37,16],[[30,1,["event","status"]],"private"],null],"discourse_post_event.builder_modal.invitees.label"]],[["default"],[[[[1,"\\n            "],[8,[39,17],null,[["@fullWidthWrap","@groupFinder","@groupNames","@onChangeCallback","@placeholderKey"],[true,[30,0,["groupFinder"]],[30,1,["event","rawInvitees"]],[30,0,["setRawInvitees"]],"topic.invite_private.group_name"]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[39,10],[[24,0,"reminders"]],[["@label"],["discourse_post_event.builder_modal.reminders.label"]],[["default"],[[[[1,"\\n            "],[10,0],[14,0,"reminders-list"],[12],[1,"\\n"],[42,[28,[37,20],[[28,[37,20],[[30,1,["event","reminders"]]],null]],null],null,[[[1,"                "],[10,0],[14,0,"reminder-item"],[12],[1,"\\n                  "],[8,[39,21],[[24,0,"reminder-type"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["type"]],"name","value",[30,0,["reminderTypes"]]]],null],[1,"\\n\\n                  "],[8,[39,11],[[24,0,"reminder-value"],[16,"min",0],[16,"placeholder",[28,[37,1],["discourse_post_event.builder_modal.name.placeholder"],null]]],[["@value"],[[30,3,["value"]]]],null],[1,"\\n\\n                  "],[8,[39,21],[[24,0,"reminder-unit"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["unit"]],"name","value",[30,0,["reminderUnits"]]]],null],[1,"\\n\\n                  "],[8,[39,21],[[24,0,"reminder-period"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["period"]],"name","value",[30,0,["reminderPeriods"]]]],null],[1,"\\n\\n                  "],[8,[39,22],[[24,0,"remove-reminder"]],[["@icon","@action"],["xmark",[28,[37,23],[[30,1,["event","removeReminder"]],[30,3]],null]]],null],[1,"\\n\\n                "],[13],[1,"\\n"]],[3]],null],[1,"            "],[13],[1,"\\n\\n            "],[8,[39,22],[[24,0,"add-reminder"]],[["@disabled","@icon","@label","@action"],[[30,0,["addReminderDisabled"]],"plus","discourse_post_event.builder_modal.add_reminder",[30,1,["event","addReminder"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[39,10],[[24,0,"recurrence"]],[["@label"],["discourse_post_event.builder_modal.recurrence.label"]],[["default"],[[[[1,"\\n            "],[8,[39,21],[[24,0,"available-recurrences"]],[["@value","@content","@options"],[[30,1,["event","recurrence"]],[30,0,["availableRecurrences"]],[28,[37,8],null,[["none"],["discourse_post_event.builder_modal.recurrence.none"]]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[39,10],[[24,0,"minimal-event"]],[["@label"],["discourse_post_event.builder_modal.minimal.label"]],[["default"],[[[[1,"\\n            "],[10,"label"],[14,0,"checkbox-label"],[12],[1,"\\n              "],[8,[39,11],null,[["@type","@checked"],["checkbox",[30,1,["event","minimal"]]]],null],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[1,[28,[35,1],["discourse_post_event.builder_modal.minimal.checkbox_label"],null]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["allowedCustomFields","length"]],[[[1,"            "],[8,[39,10],null,[["@label"],["discourse_post_event.builder_modal.custom_fields.label"]],[["default"],[[[[1,"\\n              "],[10,2],[14,0,"event-field-description"],[12],[1,"\\n                "],[1,[28,[35,1],["discourse_post_event.builder_modal.custom_fields.description"],null]],[1,"\\n              "],[13],[1,"\\n"],[42,[28,[37,20],[[28,[37,20],[[30,0,["allowedCustomFields"]]],null]],null],null,[[[1,"                "],[10,1],[14,0,"label custom-field-label"],[12],[1,"\\n                  "],[1,[30,4]],[1,"\\n                "],[13],[1,"\\n                "],[8,[39,11],[[24,0,"custom-field-input"],[16,"placeholder",[28,[37,1],["discourse_post_event.builder_modal.custom_fields.placeholder"],null]],[4,[38,27],["input",[28,[37,23],[[30,0,["setCustomField"]],[30,4]],null]],null]],[["@value"],[[28,[37,25],[[28,[37,26],[[30,1,["event","customFields"]],[30,4]],null]],null]]],null],[1,"\\n"]],[4]],null],[1,"            "]],[]]]]],[1,"\\n"]],[]],null],[1,"        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],[[[1,"\\n"],[41,[30,1,["event","id"]],[[[1,"      "],[8,[39,22],[[24,0,"btn-primary"]],[["@label","@icon","@action"],["discourse_post_event.builder_modal.update","calendar-day",[30,0,["updateEvent"]]]],null],[1,"\\n\\n      "],[8,[39,22],[[24,0,"btn-danger"]],[["@icon","@action"],["trash-can",[30,0,["destroyPostEvent"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[39,22],[[24,0,"btn-primary"]],[["@label","@icon","@action"],["discourse_post_event.builder_modal.create","calendar-day",[30,0,["createEvent"]]]],null],[1,"\\n"]],[]]],[1,"  "]],[]]]]]],["@model","@closeModal","reminder","allowedCustomField"],false,["d-modal","i18n","concat","if",":body","conditional-loading-section","form","plugin-outlet","hash","date-time-input-range","event-field","input","timezone-input","label","radio-button","span","eq","group-selector","div","each","-track-array","combo-box","d-button","fn","p","readonly","get","on",":footer"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder.hbs",isStrictMode:!1})
class m extends s.default{static#e=(()=>dt7948.g(this.prototype,"dialog",[o.service]))()
#s=(()=>{dt7948.i(this,"dialog")})()
static#t=(()=>dt7948.g(this.prototype,"siteSettings",[o.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#o=(()=>dt7948.g(this.prototype,"store",[o.service]))()
#h=(()=>{dt7948.i(this,"store")})()
static#r=(()=>dt7948.g(this.prototype,"flash",[i.tracked],(function(){return null})))()
#T=(()=>{dt7948.i(this,"flash")})()
static#p=(()=>dt7948.g(this.prototype,"isSaving",[i.tracked],(function(){return!1})))()
#j=(()=>{dt7948.i(this,"isSaving")})()
static#v=(()=>dt7948.g(this.prototype,"startsAt",[i.tracked],(function(){return moment(this.event.startsAt).tz(this.event.timezone||"UTC")})))()
#C=(()=>{dt7948.i(this,"startsAt")})()
static#g=(()=>dt7948.g(this.prototype,"endsAt",[i.tracked],(function(){return this.event.endsAt&&moment(this.event.endsAt).tz(this.event.timezone||"UTC")})))()
#O=(()=>{dt7948.i(this,"endsAt")})()
get event(){return this.args.model.event}get reminderTypes(){return[{value:"notification",name:(0,l.i18n)("discourse_post_event.builder_modal.reminders.types.notification")},{value:"bumpTopic",name:(0,l.i18n)("discourse_post_event.builder_modal.reminders.types.bump_topic")}]}get reminderUnits(){return[{value:"minutes",name:(0,l.i18n)("discourse_post_event.builder_modal.reminders.units.minutes")},{value:"hours",name:(0,l.i18n)("discourse_post_event.builder_modal.reminders.units.hours")},{value:"days",name:(0,l.i18n)("discourse_post_event.builder_modal.reminders.units.days")},{value:"weeks",name:(0,l.i18n)("discourse_post_event.builder_modal.reminders.units.weeks")}]}get reminderPeriods(){return[{value:"before",name:(0,l.i18n)("discourse_post_event.builder_modal.reminders.periods.before")},{value:"after",name:(0,l.i18n)("discourse_post_event.builder_modal.reminders.periods.after")}]}get availableRecurrences(){return[{id:"every_day",name:(0,l.i18n)("discourse_post_event.builder_modal.recurrence.every_day")},{id:"every_month",name:(0,l.i18n)("discourse_post_event.builder_modal.recurrence.every_month")},{id:"every_weekday",name:(0,l.i18n)("discourse_post_event.builder_modal.recurrence.every_weekday")},{id:"every_week",name:(0,l.i18n)("discourse_post_event.builder_modal.recurrence.every_week")},{id:"every_two_weeks",name:(0,l.i18n)("discourse_post_event.builder_modal.recurrence.every_two_weeks")},{id:"every_four_weeks",name:(0,l.i18n)("discourse_post_event.builder_modal.recurrence.every_four_weeks")}]}get allowedCustomFields(){return this.siteSettings.discourse_post_event_allowed_custom_fields.split("|").filter(Boolean)}get addReminderDisabled(){return this.event.reminders?.length>=5}groupFinder(e){return d.default.findAll({term:e,ignore_automatic:!0})}static#f=(()=>dt7948.n(this.prototype,"groupFinder",[n.action]))()
setCustomField(e,t){this.event.customFields[e]=t.target.value}static#_=(()=>dt7948.n(this.prototype,"setCustomField",[n.action]))()
onChangeDates(e){this.event.startsAt=e.from,this.event.endsAt=e.to,this.startsAt=e.from,this.endsAt=e.to}static#b=(()=>dt7948.n(this.prototype,"onChangeDates",[n.action]))()
onChangeStatus(e){this.event.rawInvitees=[],this.event.status=e}static#y=(()=>dt7948.n(this.prototype,"onChangeStatus",[n.action]))()
setRawInvitees(e,t){this.event.rawInvitees=t}static#w=(()=>dt7948.n(this.prototype,"setRawInvitees",[n.action]))()
setNewTimezone(e){this.event.timezone=e,this.event.startsAt=moment.tz(this.startsAt.format("YYYY-MM-DDTHH:mm"),e),this.event.endsAt=this.endsAt?moment.tz(this.endsAt.format("YYYY-MM-DDTHH:mm"),e):null,this.startsAt=moment(this.event.startsAt).tz(e),this.endsAt=this.event.endsAt?moment(this.event.endsAt).tz(e):null}static#A=(()=>dt7948.n(this.prototype,"setNewTimezone",[n.action]))()
async destroyPostEvent(){try{if(await this.dialog.yesNoConfirm({message:"Confirm delete"})){const e=await this.store.find("post",this.event.id),t=e.raw,s=this._removeRawEvent(t),i={raw:s,edit_reason:"Destroy event"},n=await(0,a.cook)(s)
i.cooked=n.string
await e.save(i)&&this.args.closeModal()}}catch(e){this.flash=(0,r.extractError)(e)}}static#k=(()=>dt7948.n(this.prototype,"destroyPostEvent",[n.action]))()
createEvent(){if(!this.startsAt)return void this.args.closeModal()
const e=(0,u.buildParams)(this.startsAt,this.endsAt,this.event,this.siteSettings),t=[]
Object.keys(e).forEach((s=>{let i=e[s]
t.push(`${s}="${i}"`)})),this.args.model.toolbarEvent.addText(`[event ${t.join(" ")}]\n[/event]`),this.args.closeModal()}static#E=(()=>dt7948.n(this.prototype,"createEvent",[n.action]))()
async updateEvent(){try{this.isSaving=!0
const e=await this.store.find("post",this.event.id),t=e.raw,s=(0,u.buildParams)(this.startsAt,this.endsAt,this.event,this.siteSettings),i=(0,u.replaceRaw)(s,t)
if(i){const t={raw:i,edit_reason:(0,l.i18n)("discourse_post_event.edit_reason")},s=await(0,a.cook)(i)
t.cooked=s.string
await e.save(t)&&this.args.closeModal()}}catch(e){this.flash=(0,r.extractError)(e)}finally{this.isSaving=!1}}static#x=(()=>dt7948.n(this.prototype,"updateEvent",[n.action]))()
_removeRawEvent(e){const t=new RegExp("\\[event\\s(.*?)\\]\\n\\[\\/event\\]","m")
return e.replace(t,"")}}e.default=m,(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/utils","@ember-compat/tracked-built-ins","discourse/lib/ajax","discourse/lib/ajax-error","discourse/models/group","discourse-i18n","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u,c,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,p.createTemplateFactory)({id:"WtdmbI3M",block:'[[[8,[39,0],[[24,0,"post-event-bulk-invite"]],[["@closeModal","@title","@flash"],[[30,1],[28,[37,1],["discourse_post_event.bulk_invite_modal.title"],null],[30,0,["flash"]]]],[["body"],[[[[1,"\\n    "],[10,0],[14,0,"bulk-invites"],[12],[1,"\\n      "],[10,2],[14,0,"bulk-event-help"],[12],[1,"\\n        "],[1,[28,[35,1],[[28,[37,5],["discourse_post_event.bulk_invite_modal.description_",[30,2,["event","status"]]],null]],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,"h3"],[12],[1,[28,[35,1],["discourse_post_event.bulk_invite_modal.inline_title"],null]],[13],[1,"\\n\\n      "],[10,0],[14,0,"bulk-invite-rows"],[12],[1,"\\n"],[42,[28,[37,8],[[28,[37,8],[[30,0,["bulkInvites"]]],null]],null],null,[[[1,"          "],[10,0],[14,0,"bulk-invite-row"],[12],[1,"\\n"],[41,[30,2,["event","isPrivate"]],[[[1,"              "],[8,[39,10],[[24,0,"bulk-invite-identifier"]],[["@single","@groupFinder","@groupNames","@placeholderKey","@onChangeCallback"],[true,[30,0,["groupFinder"]],[30,3,["identifier"]],"discourse_post_event.bulk_invite_modal.group_selector_placeholder",[28,[37,11],[[30,0,["updateBulkGroupInviteIdentifier"]],[30,3]],null]]],null],[1,"\\n"]],[]],null],[41,[30,2,["event","isPublic"]],[[[1,"              "],[8,[39,12],[[24,0,"bulk-invite-identifier"]],[["@value","@onChange","@options"],[[30,3,["identifier"]],[28,[37,11],[[30,0,["updateInviteIdentifier"]],[30,3]],null],[28,[37,13],null,[["maximum","filterPlaceholder"],[1,"discourse_post_event.bulk_invite_modal.user_selector_placeholder"]]]]],null],[1,"\\n"]],[]],null],[1,"\\n            "],[8,[39,14],[[24,0,"bulk-invite-attendance"]],[["@value","@content","@nameProperty","@valueProperty","@onChange"],[[30,3,["attendance"]],[30,0,["bulkInviteStatuses"]],"name","name",[28,[37,11],[[28,[37,15],[[30,3,["attendance"]]],null]],null]]],null],[1,"\\n\\n            "],[8,[39,16],[[24,0,"remove-bulk-invite"]],[["@icon","@action"],["trash-can",[28,[37,11],[[30,0,["removeBulkInvite"]],[30,3]],null]]],null],[1,"\\n          "],[13],[1,"\\n"]],[3]],null],[1,"      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"bulk-invite-actions"],[12],[1,"\\n        "],[8,[39,16],[[24,0,"send-bulk-invites btn-primary"]],[["@label","@action","@disabled"],["discourse_post_event.bulk_invite_modal.send_bulk_invites",[30,0,["sendBulkInvites"]],[30,0,["bulkInviteDisabled"]]]],null],[1,"\\n        "],[8,[39,16],[[24,0,"add-bulk-invite"]],[["@icon","@action"],["plus",[30,0,["addBulkInvite"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"csv-bulk-invites"],[12],[1,"\\n      "],[10,"h3"],[12],[1,[28,[35,1],["discourse_post_event.bulk_invite_modal.csv_title"],null]],[13],[1,"\\n\\n      "],[10,0],[14,0,"bulk-invite-actions"],[12],[1,"\\n        "],[8,[39,17],null,null,null],[1,"\\n\\n        "],[8,[39,18],null,[["@uploadUrl","@i18nPrefix","@uploadDone"],[[28,[37,5],["/discourse-post-event/events/",[30,2,["event","id"]],"/csv-bulk-invite"],null],"discourse_post_event.bulk_invite_modal",[30,0,["uploadDone"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]]],["@closeModal","@model","bulkInvite"],false,["d-modal","i18n",":body","div","p","concat","h3","each","-track-array","if","group-selector","fn","email-group-user-chooser","hash","combo-box","mut","d-button","bulk-invite-sample-csv-file","csv-uploader"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite.hbs",isStrictMode:!1})
class v extends s.default{static#e=(()=>dt7948.g(this.prototype,"dialog",[o.service]))()
#s=(()=>{dt7948.i(this,"dialog")})()
static#t=(()=>dt7948.g(this.prototype,"bulkInvites",[i.tracked],(function(){return new a.TrackedArray([n.default.create({identifier:null,attendance:"unknown"})])})))()
#I=(()=>{dt7948.i(this,"bulkInvites")})()
static#o=(()=>dt7948.g(this.prototype,"bulkInviteDisabled",[i.tracked],(function(){return!0})))()
#D=(()=>{dt7948.i(this,"bulkInviteDisabled")})()
static#r=(()=>dt7948.g(this.prototype,"flash",[i.tracked],(function(){return null})))()
#T=(()=>{dt7948.i(this,"flash")})()
get bulkInviteStatuses(){return[{label:(0,c.i18n)("discourse_post_event.models.invitee.status.unknown"),name:"unknown"},{label:(0,c.i18n)("discourse_post_event.models.invitee.status.going"),name:"going"},{label:(0,c.i18n)("discourse_post_event.models.invitee.status.not_going"),name:"not_going"},{label:(0,c.i18n)("discourse_post_event.models.invitee.status.interested"),name:"interested"}]}groupFinder(e){return u.default.findAll({term:e,ignore_automatic:!0})}static#p=(()=>dt7948.n(this.prototype,"groupFinder",[n.action]))()
setBulkInviteDisabled(){this.bulkInviteDisabled=0===this.bulkInvites.filter((e=>(0,r.isPresent)(e.identifier))).length}static#v=(()=>dt7948.n(this.prototype,"setBulkInviteDisabled",[n.action]))()
async sendBulkInvites(){try{(await(0,d.ajax)(`/discourse-post-event/events/${this.args.model.event.id}/bulk-invite.json`,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({invitees:this.bulkInvites.filter((e=>(0,r.isPresent)(e.identifier)))})})).success&&this.args.closeModal()}catch(e){this.flash=(0,l.extractError)(e)}}static#g=(()=>dt7948.n(this.prototype,"sendBulkInvites",[n.action]))()
removeBulkInvite(e){this.bulkInvites.removeObject(e),this.bulkInvites.length||this.bulkInvites.pushObject(n.default.create({identifier:null,attendance:"unknown"}))}static#f=(()=>dt7948.n(this.prototype,"removeBulkInvite",[n.action]))()
addBulkInvite(){const e=this.bulkInvites[this.bulkInvites.length-1]?.attendance||"unknown"
this.bulkInvites.pushObject(n.default.create({identifier:null,attendance:e}))}static#_=(()=>dt7948.n(this.prototype,"addBulkInvite",[n.action]))()
async uploadDone(){await this.dialog.alert((0,c.i18n)("discourse_post_event.bulk_invite_modal.success")),this.args.closeModal()}static#b=(()=>dt7948.n(this.prototype,"uploadDone",[n.action]))()
updateInviteIdentifier(e,t){e.set("identifier",t[0]),this.setBulkInviteDisabled()}static#y=(()=>dt7948.n(this.prototype,"updateInviteIdentifier",[n.action]))()
updateBulkGroupInviteIdentifier(e,t,s){e.set("identifier",s[0]),this.setBulkInviteDisabled()}static#w=(()=>dt7948.n(this.prototype,"updateBulkGroupInviteIdentifier",[n.action]))()}e.default=v,(0,t.setComponentTemplate)(m,v)})),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","discourse/lib/ajax","discourse/lib/ajax-error","@ember/template-factory"],(function(e,t,s,i,n,o,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,a.createTemplateFactory)({id:"vhApzVkq",block:'[[[8,[39,0],null,[["@title","@closeModal","@flash"],[[28,[37,1],["discourse_post_event.invite_user_or_group.title"],null],[30,1],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[10,"form"],[12],[1,"\\n      "],[8,[39,4],null,null,[["default"],[[[[1,"\\n        "],[8,[39,5],null,[["@value","@options"],[[30,0,["invitedNames"]],[28,[37,6],null,[["fullWidthWrap","includeMessageableGroups","filterPlaceholder","excludeCurrentUser"],[true,true,"composer.users_placeholder",true]]]]],null],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,8],[[24,0,"btn-primary"]],[["@type","@label","@action"],["button","discourse_post_event.invite_user_or_group.invite",[30,0,["invite"]]]],null],[1,"\\n  "]],[]]]]]],["@closeModal"],false,["d-modal","i18n",":body","form","event-field","email-group-user-chooser","hash",":footer","d-button"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group.hbs",isStrictMode:!1})
class l extends s.default{static#e=(()=>dt7948.g(this.prototype,"invitedNames",[i.tracked],(function(){return[]})))()
#N=(()=>{dt7948.i(this,"invitedNames")})()
static#t=(()=>dt7948.g(this.prototype,"flash",[i.tracked],(function(){return null})))()
#T=(()=>{dt7948.i(this,"flash")})()
async invite(){try{await(0,o.ajax)(`/discourse-post-event/events/${this.args.model.event.id}/invite.json`,{data:{invites:this.invitedNames},type:"POST"}),this.args.closeModal()}catch(e){this.flash=(0,r.extractError)(e)}}static#o=(()=>dt7948.n(this.prototype,"invite",[n.action]))()}e.default=l,(0,t.setComponentTemplate)(d,l)})),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/index",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/service","truth-helpers","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/d-modal","discourse/helpers/concat-class","discourse/lib/decorators","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/toggle-invitees","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u,c,p,m,v,g,h,f){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class _ extends t.default{static#e=(()=>dt7948.g(this.prototype,"store",[r.service]))()
#h=(()=>{dt7948.i(this,"store")})()
static#t=(()=>dt7948.g(this.prototype,"discoursePostEventApi",[r.service]))()
#d=(()=>{dt7948.i(this,"discoursePostEventApi")})()
static#o=(()=>dt7948.g(this.prototype,"filter",[s.tracked]))()
#R=(()=>{dt7948.i(this,"filter")})()
static#r=(()=>dt7948.g(this.prototype,"isLoading",[s.tracked],(function(){return!1})))()
#L=(()=>{dt7948.i(this,"isLoading")})()
static#p=(()=>dt7948.g(this.prototype,"type",[s.tracked],(function(){return"going"})))()
#$=(()=>{dt7948.i(this,"type")})()
static#v=(()=>dt7948.g(this.prototype,"inviteesList",[s.tracked]))()
#U=(()=>{dt7948.i(this,"inviteesList")})()
constructor(){super(...arguments),this._fetchInvitees()}get hasSuggestedUsers(){return this.inviteesList?.suggestedUsers?.length>0}get hasResults(){return this.inviteesList?.invitees?.length>0||this.hasSuggestedUsers}get title(){return(0,m.i18n)(`discourse_post_event.invitees_modal.${this.args.model.title||"title_invited"}`)}toggleType(e){this.type=e,this._fetchInvitees(this.filter)}static#g=(()=>dt7948.n(this.prototype,"toggleType",[o.action]))()
onFilterChanged(e){this.filter=e.target.value,this._fetchInvitees(this.filter)}static#f=(()=>dt7948.n(this.prototype,"onFilterChanged",[(0,p.debounce)(250)]))()
async removeInvitee(e){await this.discoursePostEventApi.leaveEvent(this.args.model.event,e),this.inviteesList.remove(e)}static#_=(()=>dt7948.n(this.prototype,"removeInvitee",[o.action]))()
async addInvitee(e){const t=await this.discoursePostEventApi.joinEvent(this.args.model.event,{status:this.type,user_id:e.id})
this.inviteesList.add(t)}static#b=(()=>dt7948.n(this.prototype,"addInvitee",[o.action]))()
async _fetchInvitees(e){try{this.isLoading=!0,this.inviteesList=await this.discoursePostEventApi.listEventInvitees(this.args.model.event,{type:this.type,filter:e})}finally{this.isLoading=!1}}static#y=(()=>(0,h.setComponentTemplate)((0,f.createTemplateFactory)({id:"/i2DUc8Y",block:'[[[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],[[28,[32,2],[[30,1,["extraClass"]],"invited"],null],"post-event-invitees-modal"],null]]],[["@title","@closeModal"],[[30,0,["title"]],[30,2]]],[["body"],[[[[1,"\\n        "],[11,"input"],[16,"placeholder",[28,[32,3],["discourse_post_event.invitees_modal.filter_placeholder"],null]],[24,0,"filter"],[24,4,"text"],[4,[32,4],["input",[30,0,["onFilterChanged"]]],null],[12],[13],[1,"\\n\\n        "],[8,[32,5],null,[["@viewType","@toggle"],[[30,0,["type"]],[30,0,["toggleType"]]]],null],[1,"\\n        "],[8,[32,6],null,[["@condition"],[[30,0,["isLoading"]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["hasResults"]],[[[1,"            "],[10,"ul"],[14,0,"invitees"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["inviteesList","invitees"]]],null]],null],null,[[[1,"                "],[10,"li"],[14,0,"invitee"],[12],[1,"\\n                  "],[8,[32,7],null,[["@user"],[[30,3,["user"]]]],null],[1,"\\n"],[41,[30,1,["event","canActOnDiscoursePostEvent"]],[[[1,"                    "],[8,[32,8],[[24,0,"remove-invitee"],[16,"title",[28,[32,3],["discourse_post_event.invitees_modal.remove_invitee"],null]]],[["@icon","@action"],["trash-can",[28,[32,9],[[30,0,["removeInvitee"]],[30,3]],null]]],null],[1,"\\n"]],[]],null],[1,"                "],[13],[1,"\\n"]],[3]],null],[1,"            "],[13],[1,"\\n"],[41,[30,0,["hasSuggestedUsers"]],[[[1,"              "],[10,"ul"],[14,0,"possible-invitees"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["inviteesList","suggestedUsers"]]],null]],null],null,[[[1,"                  "],[10,"li"],[14,0,"invitee"],[12],[1,"\\n                    "],[8,[32,7],null,[["@user"],[[30,4]]],null],[1,"\\n                    "],[8,[32,8],[[24,0,"add-invitee"],[16,"title",[28,[32,3],["discourse_post_event.invitees_modal.add_invitee"],null]]],[["@icon","@action"],["plus",[28,[32,9],[[30,0,["addInvitee"]],[30,4]],null]]],null],[1,"\\n                  "],[13],[1,"\\n"]],[4]],null],[1,"              "],[13],[1,"\\n"]],[]],null]],[]],[[[1,"            "],[10,2],[14,0,"no-users"],[12],[1,"\\n              "],[1,[28,[32,3],["discourse_post_event.models.invitee.no_users"],null]],[1,"\\n            "],[13],[1,"\\n"]],[]]],[1,"        "]],[]]]]],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@model","@closeModal","invitee","user"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/index.js",scope:()=>[u.default,c.default,a.or,m.i18n,n.on,v.default,d.default,g.default,l.default,i.fn],isStrictMode:!0}),this))()}e.default=_})),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user",["exports","discourse/helpers/avatar","discourse/lib/url","discourse/lib/utilities","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,n.setComponentTemplate)((0,o.createTemplateFactory)({id:"Xx8EPDPC",block:'[[[1,"\\n  "],[10,3],[15,6,[28,[32,0],[[30,1,["username"]]],null]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n    "],[10,1],[14,0,"user"],[12],[1,"\\n      "],[1,[28,[32,1],[[30,1]],[["imageSize"],["medium"]]]],[1,"\\n      "],[10,1],[14,0,"username"],[12],[1,"\\n        "],[1,[28,[32,2],[[30,1,["username"]]],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],["@user"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user.js",scope:()=>[s.userPath,t.default,i.formatUsername],isStrictMode:!0}),(0,r.default)(void 0,"user:User"))
e.default=a})),define("discourse/plugins/discourse-calendar/discourse/components/region-input",["exports","@ember/object","@ember-decorators/component","discourse-i18n","select-kit/components/combo-box","select-kit/components/select-kit","discourse/plugins/discourse-calendar/discourse/lib/regions"],(function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=dt7948.c(class extends n.default{allowNoneRegion=!1
get content(){const e={}
let t=[]
return JSON.parse(this.siteSettings.available_locales).forEach((t=>{e[t.value]=t.name})),!0===this.allowNoneRegion&&t.push({name:(0,i.i18n)("discourse_calendar.region.none"),id:null}),t=t.concat(r.HOLIDAY_REGIONS.map((e=>({name:(0,i.i18n)(`discourse_calendar.region.names.${e}`),id:e}))).sort(((e,t)=>e.name.localeCompare(t.name)))),t}static#e=(()=>dt7948.n(this.prototype,"content",[t.computed]))()},[(0,s.classNames)("timezone-input","region-input"),(0,o.pluginApiIdentifiers)("timezone-input"),(0,o.selectKitOptions)({filterable:!0,allowAny:!1})])
e.default=a})),define("discourse/plugins/discourse-calendar/discourse/components/toggle-invitees",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,i.createTemplateFactory)({id:"ZV5aDhEs",block:'[[[10,0],[14,0,"invitees-type-filter"],[12],[1,"\\n  "],[8,[39,1],[[16,0,[28,[37,2],["btn toggle-going",[52,[28,[37,4],[[30,1],"going"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.going",[28,[37,5],[[30,2],"going"],null]]],null],[1,"\\n\\n  "],[8,[39,1],[[16,0,[28,[37,2],["btn toggle-interested",[52,[28,[37,4],[[30,1],"interested"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.interested",[28,[37,5],[[30,2],"interested"],null]]],null],[1,"\\n\\n  "],[8,[39,1],[[16,0,[28,[37,2],["btn toggle-not-going",[52,[28,[37,4],[[30,1],"not_going"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.not_going",[28,[37,5],[[30,2],"not_going"],null]]],null],[1,"\\n"],[13]],["@viewType","@toggle"],false,["div","d-button","concat-class","if","eq","fn"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/components/toggle-invitees.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(n,(0,s.default)(void 0,"toggle-invitees"))})),define("discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar",["exports","@ember/component","@ember/runloop","@ember-decorators/component","rsvp","discourse/lib/get-url","discourse/lib/load-script","discourse/models/category","discourse/plugins/discourse-calendar/discourse/helpers/format-event-name","discourse/plugins/discourse-calendar/discourse/lib/add-recurrent-events","discourse/plugins/discourse-calendar/discourse/lib/full-calendar-default-options","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u,c,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,p.createTemplateFactory)({id:"7/srwNME",block:'[[[10,0],[14,1,"upcoming-events-calendar"],[12],[13]],[],false,["div"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar.hbs",isStrictMode:!1}),v=dt7948.c(class extends t.default{events=null
init(){super.init(...arguments),this._calendar=null}willDestroyElement(){super.willDestroyElement(...arguments),this._calendar&&this._calendar.destroy(),this._calendar=null}didInsertElement(){super.didInsertElement(...arguments),this._renderCalendar()}async _renderCalendar(){const e=this.site.siteSettings,t=document.getElementById("upcoming-events-calendar")
if(!t)return
t.innerHTML="",await this._loadCalendar()
const s=new window.FullCalendar.Calendar(t,{...(0,u.default)(),firstDay:1,height:"auto",eventPositioned:t=>{if(0===e.events_max_rows)return
let i=t.el.querySelector(".fc-content"),n=window.getComputedStyle(i),o=parseInt(n.lineHeight,10)
0===o&&(o=20)
let r=o*e.events_max_rows
i&&(i.style.maxHeight=`${r}px`)
let a=t.el.querySelector(".fc-title")
a&&(a.style.overflow="hidden",a.style.whiteSpace="pre-wrap"),s.updateSize()}})
this._calendar=s
const i=JSON.parse(e.map_events_to_color),n=await this.events;((0,l.default)(n)||[]).forEach((e=>{const{startsAt:t,endsAt:s,post:n,categoryId:r}=e
let l
if(n.topic.tags){const e=i.find((e=>"tag"===e.type&&n.topic.tags.includes(e.slug)))
l=e?.color}if(!l){const e=i.find((e=>"category"===e.type&&e.slug===n.topic.category_slug))
l=e?.color}const u=a.default.findById(r)?.color
let p
!l&&u&&(l=`#${u}`),moment(s||t).isBefore(moment())&&(p="fc-past-event"),this._calendar.addEvent({title:(0,d.formatEventName)(e),start:t,end:s||t,allDay:!(0,c.isNotFullDayEvent)(moment(t),moment(s)),url:(0,o.default)(`/t/-/${n.topic.id}/${n.post_number}`),backgroundColor:l,classNames:p})})),this._calendar.render()}_loadCalendar(){return new n.Promise((e=>{(0,r.default)("/plugins/discourse-calendar/javascripts/fullcalendar-with-moment-timezone.min.js").then((()=>{(0,s.schedule)("afterRender",(()=>{this.isDestroying||this.isDestroyed||e()}))}))}))}},[(0,i.tagName)("")])
e.default=(0,t.setComponentTemplate)(m,v)}))
define("discourse/plugins/discourse-calendar/discourse/components/upcoming-events-list",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/routing","@ember/service","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/plugin-outlet","discourse/lib/ajax","discourse-i18n","truth-helpers/helpers/or","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l,u,c,p,m,v){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.DEFAULT_TIME_FORMAT=void 0
const g=e.DEFAULT_TIME_FORMAT="LT"
function h(e,t,s){const i=e.date(),n=e.format("YYYY-MM")
s[n]=s[n]??{},s[n][i]=s[n][i]??[],s[n][i].push(t)}class f extends t.default{static#e=(()=>dt7948.g(this.prototype,"appEvents",[o.service]))()
#P=(()=>{dt7948.i(this,"appEvents")})()
static#t=(()=>dt7948.g(this.prototype,"siteSettings",[o.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#o=(()=>dt7948.g(this.prototype,"router",[o.service]))()
#m=(()=>{dt7948.i(this,"router")})()
static#r=(()=>dt7948.g(this.prototype,"isLoading",[s.tracked],(function(){return!0})))()
#L=(()=>{dt7948.i(this,"isLoading")})()
static#p=(()=>dt7948.g(this.prototype,"hasError",[s.tracked],(function(){return!1})))()
#B=(()=>{dt7948.i(this,"hasError")})()
static#v=(()=>dt7948.g(this.prototype,"eventsByMonth",[s.tracked],(function(){return{}})))()
#F=(()=>{dt7948.i(this,"eventsByMonth")})()
timeFormat=(()=>this.args.params?.timeFormat??g)()
count=(()=>this.args.params?.count??8)()
upcomingDays=(()=>this.args.params?.upcomingDays??180)()
emptyMessage=(()=>(0,u.i18n)("discourse_post_event.upcoming_events_list.empty"))()
allDayLabel=(()=>(0,u.i18n)("discourse_post_event.upcoming_events_list.all_day"))()
errorMessage=(()=>(0,u.i18n)("discourse_post_event.upcoming_events_list.error"))()
viewAllLabel=(()=>(0,u.i18n)("discourse_post_event.upcoming_events_list.view_all"))()
constructor(){super(...arguments),this.appEvents.on("page:changed",this,this.updateEventsList)}get categoryId(){return this.router.currentRoute.attributes?.category?.id}get hasEmptyResponse(){return!this.isLoading&&!this.hasError&&0===Object.keys(this.eventsByMonth).length}get title(){const e=this.router.currentRoute.attributes?.category?.slug,t=this.siteSettings.map_events_title
if(""===t)return(0,u.i18n)("discourse_post_event.upcoming_events_list.title")
if(JSON.parse(t).map((e=>{let{category_slug:t}=e
return t})).includes(e)){const s=JSON.parse(t).find((t=>t.category_slug===e))
return s?.custom_title}return(0,u.i18n)("discourse_post_event.upcoming_events_list.title")}async updateEventsList(){this.isLoading=!0,this.hasError=!1
const e={limit:this.count,before:moment().add(this.upcomingDays,"days").toISOString()}
this.categoryId&&(e.category_id=this.categoryId)
try{const{events:t}=await(0,l.ajax)("/discourse-post-event/events",{data:e})
this.eventsByMonth=this.groupByMonthAndDay(t)}catch{this.hasError=!0}finally{this.isLoading=!1}}static#g=(()=>dt7948.n(this.prototype,"updateEventsList",[i.action]))()
formatTime(e){let{starts_at:t,ends_at:s}=e
return(0,p.isNotFullDayEvent)(moment(t),moment(s))?moment(t).format(this.timeFormat):this.allDayLabel}static#f=(()=>dt7948.n(this.prototype,"formatTime",[i.action]))()
startsAtMonth(e,t){return moment(`${e}-${t}`).format("MMM")}static#_=(()=>dt7948.n(this.prototype,"startsAtMonth",[i.action]))()
startsAtDay(e,t){return moment(`${e}-${t}`).format("D")}static#b=(()=>dt7948.n(this.prototype,"startsAtDay",[i.action]))()
groupByMonthAndDay(e){return e.reduce(((e,t)=>{const s=moment(t.starts_at),i=t.ends_at?moment(t.ends_at):null,n=moment()
if(!i)return h(s,t,e),e
for(;s.isSameOrBefore(i,"day");)s.isAfter(n)&&h(s,t,e),s.add(1,"day")
return e}),{})}static#y=(()=>(0,m.setComponentTemplate)((0,v.createTemplateFactory)({id:"bLph0vTS",block:'[[[1,"\\n    "],[10,0],[14,0,"upcoming-events-list"],[12],[1,"\\n      "],[10,"h3"],[14,0,"upcoming-events-list__heading"],[12],[1,"\\n        "],[1,[30,0,["title"]]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"upcoming-events-list__container"],[12],[1,"\\n        "],[8,[32,0],null,[["@condition"],[[30,0,["isLoading"]]]],null],[1,"\\n\\n"],[41,[30,0,["hasEmptyResponse"]],[[[1,"          "],[10,0],[14,0,"upcoming-events-list__empty-message"],[12],[1,"\\n            "],[1,[30,0,["emptyMessage"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hasError"]],[[[1,"          "],[10,0],[14,0,"upcoming-events-list__error-message"],[12],[1,"\\n            "],[1,[30,0,["errorMessage"]]],[1,"\\n          "],[13],[1,"\\n          "],[8,[32,1],[[24,0,"btn-link upcoming-events-list__try-again"]],[["@action","@label"],[[30,0,["updateEventsList"]],"discourse_post_event.upcoming_events_list.try_again"]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[51,[30,0,["isLoading"]]],[[[1,"          "],[8,[32,2],null,[["@name"],["upcoming-events-list-container"]],[["default"],[[[[1,"\\n"],[42,[28,[31,3],[[30,0,["eventsByMonth"]]],null],null,[[[42,[28,[31,3],[[30,1]],null],null,[[[42,[28,[31,4],[[28,[31,4],[[30,3]],null]],null],null,[[[1,"                  "],[10,3],[14,0,"upcoming-events-list__event"],[15,6,[30,5,["post","url"]]],[12],[1,"\\n                    "],[10,0],[14,0,"upcoming-events-list__event-date"],[12],[1,"\\n                      "],[10,0],[14,0,"month"],[12],[1,[28,[30,0,["startsAtMonth"]],[[30,2],[30,4]],null]],[13],[1,"\\n                      "],[10,0],[14,0,"day"],[12],[1,[28,[30,0,["startsAtDay"]],[[30,2],[30,4]],null]],[13],[1,"\\n                    "],[13],[1,"\\n                    "],[10,0],[14,0,"upcoming-events-list__event-content"],[12],[1,"\\n                      "],[10,1],[14,0,"upcoming-events-list__event-name"],[15,"title",[28,[32,3],[[30,5,["name"]],[30,5,["post","topic","title"]]],null]],[12],[1,"\\n                        "],[1,[28,[32,3],[[30,5,["name"]],[30,5,["post","topic","title"]]],null]],[1,"\\n                      "],[13],[1,"\\n"],[41,[30,0,["timeFormat"]],[[[1,"                        "],[10,1],[14,0,"upcoming-events-list__event-time"],[12],[1,"\\n                          "],[1,[28,[30,0,["formatTime"]],[[30,5]],null]],[1,"\\n                        "],[13],[1,"\\n"]],[]],null],[1,"                    "],[13],[1,"\\n                  "],[13],[1,"\\n"]],[5]],null]],[3,4]],null]],[1,2]],null],[1,"          "]],[]]]]],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"upcoming-events-list__footer"],[12],[1,"\\n        "],[8,[32,4],[[24,0,"upcoming-events-list__view-all"]],[["@route"],["discourse-post-event-upcoming-events"]],[["default"],[[[[1,"\\n          "],[1,[30,0,["viewAllLabel"]]],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["monthData","month","events","day","event"],false,["if","unless","each","-each-in","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/components/upcoming-events-list.js",scope:()=>[r.default,a.default,d.default,c.default,n.LinkTo],isStrictMode:!0}),this))()}e.default=f})),define("discourse/plugins/discourse-calendar/discourse/connectors/before-topic-list-body/category-calendar",["exports","@glimmer/component","@ember/component","@ember/template-factory"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{static shouldRender(e,t){return"before-topic-list-body"===t.siteSettings.calendar_categories_outlet}static#e=(()=>(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"s4OTe9xw",block:'[[[1,"\\n    "],[10,0],[14,0,"before-topic-list-body-outlet category-calendar"],[12],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/before-topic-list-body/category-calendar.js",isStrictMode:!0}),this))()}e.default=n})),define("discourse/plugins/discourse-calendar/discourse/connectors/discovery-list-container-top/category-events-calendar",["exports","@glimmer/component","@ember/component","@ember/template-factory"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{static shouldRender(e,t){return"discovery-list-container-top"===t.siteSettings.calendar_categories_outlet}static#e=(()=>(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"1b80e/zg",block:'[[[1,"\\n    "],[10,0],[14,1,"category-events-calendar"],[12],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/discovery-list-container-top/category-events-calendar.js",isStrictMode:!0}),this))()}e.default=n})),define("discourse/plugins/discourse-calendar/discourse/connectors/header-topic-title-suffix/event-date-container",["exports","discourse/plugins/discourse-calendar/discourse/components/event-date","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"1C/MLESD",block:'[[[1,"\\n  "],[8,[32,0],null,[["@topic"],[[30,1,["topic"]]]],null],[1,"\\n"]],["@outletArgs"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/header-topic-title-suffix/event-date-container.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"event-date-container:EventDateContainer"))
e.default=o})),define("discourse/plugins/discourse-calendar/discourse/connectors/topic-list-after-title/event-badge",["exports","@glimmer/component","@ember/service","discourse/plugins/discourse-calendar/discourse/components/event-date","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#t=(()=>(0,n.setComponentTemplate)((0,o.createTemplateFactory)({id:"HUnvx4VE",block:'[[[41,[30,0,["siteSettings","discourse_post_event_enabled"]],[[[41,[30,1,["topic","event_starts_at"]],[[[8,[32,0],null,[["@topic"],[[30,1,["topic"]]]],null]],[]],null]],[]],null]],["@outletArgs"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/topic-list-after-title/event-badge.js",scope:()=>[i.default],isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/discourse-calendar/discourse/connectors/user-custom-preferences/region",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/region-input","discourse/plugins/discourse-calendar/discourse/lib/regions","@ember/component","@ember/template-factory"],(function(e,t,s,i,n,o,r,a,d,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static shouldRender(e,t){return t.siteSettings.calendar_enabled}static#e=(()=>dt7948.g(this.prototype,"siteSettings",[i.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
onChange(e){this.args.outletArgs.model.set("custom_fields.holidays-region",e)}static#t=(()=>dt7948.n(this.prototype,"onChange",[s.action]))()
useCurrentRegion(){this.args.outletArgs.model.set("custom_fields.holidays-region",a.TIME_ZONE_TO_REGION[moment.tz.guess()]||"us")}static#o=(()=>dt7948.n(this.prototype,"useCurrentRegion",[s.action]))()
static#r=(()=>(0,d.setComponentTemplate)((0,l.createTemplateFactory)({id:"gQBAam+3",block:'[[[1,"\\n    "],[10,0],[14,0,"control-group region"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[32,0],["discourse_calendar.region.title"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"controls"],[12],[1,"\\n        "],[8,[32,1],null,[["@value","@allowNoneRegion","@onChange"],[[30,1,["model","custom_fields","holidays-region"]],true,[30,0,["onChange"]]]],null],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[32,2],null,[["@icon","@label","@action"],["globe","discourse_calendar.region.use_current_region",[30,0,["useCurrentRegion"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@outletArgs"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/connectors/user-custom-preferences/region.js",scope:()=>[o.i18n,r.default,n.default],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/discourse-calendar/discourse/controllers/admin-plugins-calendar",["exports","@ember/controller","@ember/object","discourse/lib/ajax","discourse/lib/ajax-error"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{selectedRegion=null
loading=!1
async getHolidays(e){if(!this.loading)return this.set("selectedRegion",e),this.set("loading",!0),(0,i.ajax)(`/admin/discourse-calendar/holiday-regions/${e}/holidays`).then((e=>{this.model.set("holidays",e.holidays)})).catch(n.popupAjaxError).finally((()=>this.set("loading",!1)))}static#e=(()=>dt7948.n(this.prototype,"getHolidays",[s.action]))()}e.default=o})),define("discourse/plugins/discourse-calendar/discourse/controllers/discourse-post-event-upcoming-events-index",["exports","@ember/controller"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{}e.default=s})),define("discourse/plugins/discourse-calendar/discourse/discourse-event-upcoming-events-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.route("discourse-post-event-upcoming-events",{path:"/upcoming-events"},(function(){this.route("index",{path:"/"})}))}})),define("discourse/plugins/discourse-calendar/discourse/helpers/format-event-name",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.formatEventName=function(e){return e.name||e.post.topic.title}})),define("discourse/plugins/discourse-calendar/discourse/helpers/format-future-date",["exports","@ember/template","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){e=moment.utc(e).tz(moment.tz.guess())
const i=(0,s.default)(e)
return(0,t.htmlSafe)(e.format(i))}})),define("discourse/plugins/discourse-calendar/discourse/initializers/add-event-ui-builder",["exports","discourse/lib/plugin-api","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder"],(function(e,t,s,i){"use strict"
function n(e){const t=e.getCurrentUser(),n=e.container.lookup("service:modal")
e.addComposerToolbarPopupMenuOption({action:e=>{const t=s.default.create({status:"public",starts_at:moment(),timezone:moment.tz.guess()})
n.show(i.default,{model:{event:t,toolbarEvent:e}})},group:"insertions",icon:"calendar-day",label:"discourse_post_event.builder_modal.attach",condition:e=>{if(!t||!t.can_create_discourse_post_event)return!1
const s=e.model
return s&&!s.replyingToTopic&&(s.topicFirstPost||s.creatingPrivateMessage||s.editingPost&&s.post&&1===s.post.post_number)}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"add-post-event-builder",initialize(e){e.lookup("service:site-settings").discourse_post_event_enabled&&(0,t.withPluginApi)("0.8.7",n)}}})),define("discourse/plugins/discourse-calendar/discourse/initializers/add-upcoming-events-to-sidebar",["exports","discourse/lib/plugin-api","discourse-i18n"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"add-upcoming-events-to-sidebar",initialize(e){const i=e.lookup("service:site-settings")
i.discourse_post_event_enabled&&i.sidebar_show_upcoming_events&&(0,t.withPluginApi)("0.8.7",(e=>{e.addCommunitySectionLink((e=>class extends e{name="upcoming-events"
route="discourse-post-event-upcoming-events"
text=(()=>(0,s.i18n)("discourse_post_event.upcoming_events.title"))()
title=(()=>(0,s.i18n)("discourse_post_event.upcoming_events.title"))()}))}))}}})),define("discourse/plugins/discourse-calendar/discourse/initializers/disable-sort",["exports","discourse/lib/decorators","discourse/lib/deprecated","discourse/lib/plugin-api"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"disable-sort",initialize(e){(0,i.withPluginApi)("0.8",(i=>{(0,s.withSilencedDeprecations)("discourse.hbr-topic-list-overrides",(()=>{i.modifyClass("component:topic-list",(e=>class extends e{sortable(e,t){const s=t&&!!e?.custom_fields?.disable_topic_resorting
return super.sortable&&!s}static#e=(()=>dt7948.n(this.prototype,"sortable",[(0,t.default)("category","siteSettings.disable_resorting_on_categories_enabled")]))()}))})),i.registerValueTransformer("topic-list-header-sortable-column",(t=>{let{value:s,context:i}=t
if(!s)return s
return!(e.lookup("service:site-settings").disable_resorting_on_categories_enabled&&i.category?.custom_fields?.disable_topic_resorting)}))}))}}})),define("discourse/plugins/discourse-calendar/discourse/initializers/discourse-calendar",["exports","@ember/utils","jquery","pretty-text/sanitizer","rsvp","discourse/lib/ajax","discourse/lib/get-url","discourse/lib/icon-library","discourse/lib/load-script","discourse/lib/plugin-api","discourse/lib/text","discourse/lib/url","discourse/lib/utilities","discourse/models/category","discourse-i18n","discourse/plugins/discourse-calendar/discourse/helpers/format-event-name","discourse/plugins/discourse-calendar/discourse/lib/add-recurrent-events","discourse/plugins/discourse-calendar/discourse/lib/colors","discourse/plugins/discourse-calendar/discourse/lib/full-calendar-default-options","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","discourse/plugins/discourse-calendar/discourse/lib/popover"],(function(e,t,s,i,n,o,r,a,d,l,u,c,p,m,v,g,h,f,_,b,y){"use strict"
function w(){return(0,d.default)("/plugins/discourse-calendar/javascripts/fullcalendar-with-moment-timezone.min.js")}function A(e){const d=e.container.lookup("service:site-settings")
if(d.login_required&&!e.getCurrentUser())return
let l,A=d.default_timezone_offset_user_option
const k=d.calendar_categories_outlet,E=e.container.lookup("service:site"),x=E&&E.mobileView,M=e.container.lookup("service:router")
let z=`.${k}-outlet`
function S(t,i){const n=function(e,t){let s=e.attr("data-calendar-default-timezone")
moment.tz.zone(s)||(s=null)
return s||t?.timezone||moment.tz.guess()}(t=t.empty(),e.getCurrentUser()),o=function(e,t){let s=document.querySelector(".discourse-calendar-header > .discourse-calendar-title")
const i=(0,p.escapeExpression)(e.attr("data-calendar-default-view")||(x?"listNextYear":"month")),n="false"!==e.attr("data-calendar-show-add-to-calendar")
return new window.FullCalendar.Calendar(e[0],{...(0,_.default)(),timeZone:t,timeZoneImpl:"moment-timezone",nextDayThreshold:"06:00:00",displayEventEnd:!0,height:650,firstDay:1,defaultView:i,views:{listNextYear:{type:"list",duration:{days:365},buttonText:"list",listDayFormat:{month:"long",year:"numeric",day:"numeric",weekday:"long"}}},header:{left:"prev,next today",center:"title",right:"month,basicWeek,listNextYear"},eventOrder:["start",P,"-participantCount","-duration","allDay","title"],datesRender:e=>{n&&R(e),s.innerText=e.view.title},eventPositioned:e=>{(function(e){if(!d.enable_timezone_offset_for_calendar_events||!A||"listNextYear"===e.view.type)return
const t=e.event.extendedProps.timezoneOffset,s=e.el.parentNode?.colSpan,i=100/s,n=5.5-s
if(t>0){if(e.isStart){const s=Math.abs(t)/24,o=i*s+"%",r=n*s+2+"px"
e.el.style.marginLeft=`calc(${o} + ${r})`}if(e.isEnd){const s=(24-Math.abs(t))/24,o=i*s+"%",r=n*s+2+"px"
e.el.style.marginRight=`calc(${o} + ${r})`}}else if(t<0){if(e.isStart){const s=(24-Math.abs(t))/24,o=i*s+"%",r=n*s+2+"px"
e.el.style.marginLeft=`calc(${o} + ${r})`}if(e.isEnd){const s=Math.abs(t)/24,o=i*s+"%",r=n*s+2+"px"
e.el.style.marginRight=`calc(${o} + ${r})`}}})(e)}})}(t,n),r="static"===t.attr("data-calendar-type"),u="true"===t.attr("data-calendar-full-day")
r?(o.render(),function(e,t,i){(0,s.default)(`<div>${i.cooked}</div>`).find('.calendar[data-calendar-type="static"] p').html().trim().split("<br>").forEach((t=>{const i=s.default.parseHTML(t),n=i.filter((e=>(0,s.default)(e).hasClass("discourse-local-date")))
let o=j(T((0,s.default)(n[0])),T((0,s.default)(n[1])))
o.title=i[0].textContent.trim(),e.addEvent(o)}))}(o,0,i)):(D(o,i,u,n),o.render(),function(t,s){const i="false"===s.attr("data-weekends"),n=s.attr("data-hidden-days")
i&&t.setOption("weekends",!1)
n&&t.setOption("hiddenDays",n.split(",").map((e=>parseInt(e,10))))
t.setOption("eventClick",(t=>{let{event:s,jsEvent:i}=t;(0,y.destroyPopover)()
const{htmlContent:n,postNumber:o,postUrl:r}=s.extendedProps
r?c.default.routeTo(r):o?(l=l||e.container.lookup("controller:topic"),l.send("jumpToPost",o)):x&&n&&(0,y.buildPopover)(i,n)})),t.setOption("eventMouseEnter",(e=>{let{event:t,jsEvent:s}=e;(0,y.destroyPopover)()
const{htmlContent:i}=t.extendedProps;(0,y.buildPopover)(s,i)})),t.setOption("eventMouseLeave",(()=>{(0,y.destroyPopover)()}))}(o,t))
const m=()=>{const e=o.getOption("timeZone")
o.getEvents().forEach((e=>e.remove())),D(o,i,u,e)};(function(e,t,s){const i=document.querySelector(".discourse-calendar-timezone-picker")
i?(i.addEventListener("change",(function(t){e.setOption("timeZone",t.target.value),A&&(s(),R(e))})),moment.tz.names().filter((e=>!e.startsWith("Etc/GMT"))).forEach((e=>{i.appendChild(new Option(e,e))})),i.value=t):document.querySelector(".discourse-calendar-timezone-wrap").innerText=t})(o,n,m),d.enable_timezone_offset_for_calendar_events&&function(e){const t=document.querySelector(".discourse-calendar-timezone-wrap"),s=document.createElement("button")
s.title=(0,v.i18n)("discourse_calendar.toggle_timezone_offset_title"),s.classList.add("timezone-offset-button","btn","btn-default","btn-icon","no-text"),s.innerHTML=(0,a.iconHTML)("globe"),t.appendChild(s),s.addEventListener("click",(()=>{A=!A,e(),s.blur()}))}(m)}function P(e,t){if(!d.enable_timezone_offset_for_calendar_events&&!A)return 0
const s=e.extendedProps.timezoneOffset,i=t.extendedProps.timezoneOffset
return s===i?0:s<i?-1:1}function T(e){const t=e.attr("data-date")
if(!t)return null
const s=e.attr("data-time"),i=e.attr("data-timezone")
let n=t
return s&&(n=`${n} ${s}`),{weeklyRecurring:"1.weeks"===e.attr("data-recurring"),dateTime:moment.tz(n,i||"Etc/UTC")}}function j(e,t){const s=e=>!!e&&(0!==e.hours()||0!==e.minutes()||0!==e.seconds()),i=s(t?.dateTime)||s(e?.dateTime),n=i?"YYYY-MM-DD HH:mm:ssZ":"YYYY-MM-DD"
let o={start:e.dateTime.format(n),allDay:!1}
return t?i?o.end=t.dateTime.format(n):(o.end=t.dateTime.add(1,"days").format(n),o.allDay=!0):o.allDay=!0,e.weeklyRecurring&&(o.startTime={hours:e.dateTime.hours(),minutes:e.dateTime.minutes(),seconds:e.dateTime.seconds()},o.daysOfWeek=[e.dateTime.day()]),o}function C(e){const t=j(e.from?{dateTime:moment(e.from),weeklyRecurring:"1.weeks"===e.recurring}:null,e.to?{dateTime:moment(e.to),weeklyRecurring:"1.weeks"===e.recurring}:null)
return t.extendedProps={},e.post_url?t.extendedProps.postUrl=e.post_url:e.post_number?t.extendedProps.postNumber=e.post_number:t.classNames=["holiday"],e.timezoneOffset&&(t.extendedProps.timezoneOffset=e.timezoneOffset),t}function O(e,t,s){const n=C(s),o=parseInt(d.holiday_calendar_topic_id,10),r=s.message.split("\n").filter((e=>e))
if(r.length&&t.topic_id&&o!==t.topic_id)n.title=r[0],n.extendedProps.description=r.slice(1).join(" ")
else{const e=(0,f.stringToColor)(s.username)
n.title=s.username,n.backgroundColor=(0,f.colorToHex)(e),n.textColor=(0,f.contrastColor)(e)}let a=s.message.slice(0,100)
s.message.length>100&&(a+="…"),n.extendedProps.htmlContent=(0,i.escape)(a),n.title=n.title.replace(/<img[^>]*>/g,""),n.participantCount=1,e.addEvent(n)}function I(e,t,s,i,n){const o=d.enable_timezone_offset_for_calendar_events&&A&&i?function(e,t){const s=moment.tz(t).utcOffset()
let i=[],n=[]
return Object.values(e.localEvents).forEach((e=>{e.users.forEach((e=>{const t=moment.tz(e.timezone).utcOffset(),n=(s-t)/60
e.timezoneOffset=n,i.push(n)}))})),[...new Set(i)].forEach(((t,s)=>{let i={},o=[]
if(Object.keys(e.localEvents).forEach((n=>{const r=d.split_grouped_events_by_timezone_threshold,a=e.localEvents[n].users.filter((e=>Math.abs(e.timezoneOffset-(t+r*s))<=r))
a.length>0&&(i[n]={users:a},a.forEach((t=>{e.localEvents[n].users.splice(e.localEvents[n].users.findIndex((e=>e.username===t.username)),1),o.find((e=>e.timezoneOffset===t.timezoneOffset))||o.push({timezone:t.timezone,timezoneOffset:t.timezoneOffset})})))})),Object.keys(i).length>0){const t=function(e){const t=e.reduce(((e,t)=>e+t.timezoneOffset),0),s=t/e.length
return e.reduce(((e,t)=>Math.abs(t.timezoneOffset-s)<Math.abs(e.timezoneOffset-s)?t:e))}(o)
let s=moment.tz(e.from,t.timezone),r=moment.tz(e.to,t.timezone)
N(s,r,t.timezoneOffset),n.push({timezoneOffset:t.timezoneOffset,localEvents:i,from:s.format("YYYY-MM-DD"),to:r.format("YYYY-MM-DD")})}})),n}(s,n):[s]
o.forEach((t=>{let s="",i=[],n=[]
Object.keys(t.localEvents).sort().forEach((e=>{const o=t.localEvents[e]
s+=`<b>${e}</b>: ${o.users.map((e=>e.username)).sort().join(", ")}<br>`,i=i.concat(o.users),n.push(e)}))
const o=C(t)
o.classNames=["grouped-event"],i.length>2?o.title=`(${i.length}) ${n[0]}`:1===i.length?o.title=i[0].username:o.title=x?`(${i.length}) ${n[0]}`:`(${i.length}) `+i.map((e=>e.username)).join(", "),n.length>1||i.length>1?o.extendedProps.htmlContent=s:o.extendedProps.htmlContent=n[0],o.participantCount=i.length,e.addEvent(o)}))}function D(e,t,s,i){const n=[],o=moment.tz(i).utcOffset();(t.calendar_details||[]).forEach((i=>{switch(i.type){case"grouped":s&&i.timezone&&(i.from=moment.tz(i.from,i.timezone).format("YYYY-MM-DD")),n.push(i)
break
case"standalone":if(s&&i.timezone){const s={...i}
let n=moment.tz(i.from,i.timezone),r=moment.tz(i.to,i.timezone)
if(d.enable_timezone_offset_for_calendar_events&&A){const e=moment.tz(i.timezone).utcOffset(),t=(o-e)/60
s.timezoneOffset=t,N(n,r,t)}s.from=n.format("YYYY-MM-DD"),s.to=r.format("YYYY-MM-DD"),O(e,t,s)}else O(e,t,i)}}))
const r={}
n.forEach((e=>{const t=s?moment(e.from).format("YYYY-MM-DD"):moment(e.from).utc().startOf("day").toISOString(),i=s?moment(e.to||e.from).format("YYYY-MM-DD"):moment(e.to||e.from).utc().endOf("day").toISOString(),n=`${t}-${i}`
r[n]=r[n]||{from:t,to:i||t,localEvents:{}},r[n].localEvents[e.name]=r[n].localEvents[e.name]||{users:[]},r[n].localEvents[e.name].users.push.apply(r[n].localEvents[e.name].users,e.users)})),Object.keys(r).forEach((t=>{const n=r[t]
I(e,0,n,s,i)}))}function N(e,t,s){s>0?t.isValid()?t.add(1,"day"):t=e.clone().add(1,"day"):s<0&&(t.isValid()||(t=e.clone()),e.subtract(1,"day"))}function R(e){if("listNextYear"!==e.view.type)return
const t=e.view.eventRenderer.segs,s=function(e){let t={}
for(let s of e.view.calendar.getEvents())t[s._instance.defId]={start:s.start,end:s.end}
return t}(e)
for(const i of t)L(i,s)}function L(e,t){const s=e.eventRange.def.title
let i=t[e.eventRange.def.defId],n=i.start,o=i.end
o=o?$(o,e.eventRange.def.allDay):function(e,t){const s=t?"days":"hours"
return $(moment(e).add(1,s).toDate(),t)}(n,e.eventRange.def.allDay),n=$(n,e.eventRange.def.allDay)
const r=document.createElement("a"),a=(0,v.i18n)("discourse_calendar.add_to_calendar")
r.title=a,r.appendChild(document.createTextNode(a)),r.href=`\n      http://www.google.com/calendar/event?action=TEMPLATE&text=${encodeURIComponent(s)}&dates=${n}/${o}&details=${encodeURIComponent(e.eventRange.def.extendedProps.description)}`,r.target="_blank",r.classList.add("fc-list-item-add-to-calendar"),e.el.querySelector(".fc-list-item-title").appendChild(r)}function $(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?moment(e).utc().format("YYYYMMDD"):e.toISOString().replace(/-|:|\.\d\d\d/g,"")}"before-topic-list-body"===k&&(z=`.topic-list:not(.shared-drafts) .${k}-outlet`),e.onPageChange((async i=>{const a=document.querySelector(`${z}.category-calendar`)
a&&(a.innerHTML="")
const l=document.getElementById("category-events-calendar")
l&&(l.innerHTML="")
const c=M.recognize(i)
if(!c?.params?.category_slug_path_with_id)return
const v=m.default.findBySlugPathWithID(c.params.category_slug_path_with_id)
if(!v)return
const f=d.calendar_categories.split("|").filter(Boolean).map((e=>{const t={}
return e.split(";").filter(Boolean).forEach((e=>{const s=e.split("=")
t[s[0]]=s[1]})),t})).findBy("categoryId",v.id.toString())
if(a&&f&&f.postId){const e=f.postId
a.innerHTML='<div class="calendar"><div class="spinner medium"></div></div>',await w()
const i=[`postId=${e}`];["weekends","tzPicker","defaultView"].forEach((e=>{(0,t.isPresent)(f[e])&&i.push(`${e}=${(0,p.escapeExpression)(f[e])}`)}))
const r=`[calendar ${i.join(" ")}]\n[/calendar]`,d=(0,u.cook)(r),l=(0,o.ajax)(`/posts/${e}.json`),[c,m]=await n.Promise.all([d,l])
a.innerHTML=c.toString(),S((0,s.default)(".calendar"),m)}else{if(!l)return
if(d.events_calendar_categories.split("|").find((e=>e===v.id.toString()))){await w()
let t=new window.FullCalendar.Calendar(l,{...(0,_.default)(),firstDay:1,eventPositioned:e=>{if(0===d.events_max_rows)return
let s=e.el.querySelector(".fc-content"),i=window.getComputedStyle(s),n=parseInt(i.lineHeight,10)
0===n&&(n=20)
let o=n*d.events_max_rows
s&&(s.style.maxHeight=`${o}px`)
let r=e.el.querySelector(".fc-title")
r&&(r.style.overflow="hidden",r.style.whiteSpace="pre-wrap"),t.updateSize()}})
const s={category_id:v.id,include_subcategories:!0}
d.include_expired_events_on_calendar&&(s.include_expired=!0)
const i=JSON.parse(d.map_events_to_color),n=e.container.lookup("service:discourse-post-event-api"),o=await n.events(s);(0,h.default)(o).forEach((e=>{const{startsAt:s,endsAt:n,post:o,categoryId:a}=e
let d,l
if(o.topic.tags){const e=i.find((e=>"tag"===e.type&&o.topic.tags.includes(e.slug)))
d=e?e.color:null}if(!d){const e=i.find((e=>"category"===e.type&&e.slug===o.topic.category_slug))?.color
d=e||`#${m.default.findById(a)?.color}`}moment(n||s).isBefore(moment())&&(l="fc-past-event"),t.addEvent({title:(0,g.formatEventName)(e),start:s,end:n||s,allDay:!(0,b.isNotFullDayEvent)(moment(s),moment(n)),url:(0,r.default)(`/t/-/${o.topic.id}/${o.post_number}`),backgroundColor:d,classNames:l})})),t.render()}}})),e.decorateCooked(((e,t)=>function(e,t){const i=(0,s.default)(".calendar",e)
if(0===i.length)return
w().then((()=>S(i,t.getModel())))}(e,t)),{onlyStream:!0,id:"discourse-calendar"}),e.registerCustomPostMessageCallback("calendar_change",(e=>{const t=e.get("model.postStream"),i=t.findLoadedPost(t.get("firstPostId")),n=(0,s.default)(".topic-post article#post_1").find(".calendar").first()
i&&n.length>0&&(0,o.ajax)(`/posts/${i.id}.json`).then((()=>w().then((()=>S(n,i)))))})),e.registerNotificationTypeRenderer&&(e.registerNotificationTypeRenderer("event_reminder",(e=>class extends e{get linkTitle(){return this.notification.data.title?(0,v.i18n)(this.notification.data.title):super.linkTitle}get icon(){return"calendar-day"}get label(){return(0,v.i18n)(this.notification.data.message)}get description(){return this.notification.data.topic_title}})),e.registerNotificationTypeRenderer("event_invitation",(e=>class extends e{get icon(){return"calendar-day"}get label(){return"discourse_post_event.notifications.invite_user_predefined_attendance_notification"===this.notification.data.message?(0,v.i18n)(this.notification.data.message,{username:this.username}):super.label}get description(){return this.notification.data.topic_title}})))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-calendar",initialize(e){e.lookup("service:site-settings").calendar_enabled&&(0,l.withPluginApi)("0.8.22",A)}}})),define("discourse/plugins/discourse-calendar/discourse/initializers/discourse-group-timezones",["exports","jquery","discourse/lib/get-owner","discourse/lib/plugin-api","discourse/widgets/glue"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-group-timezones",initialize(){(0,i.withPluginApi)("0.8.7",(e=>{let i=[]
function o(o,r){const a=(0,t.default)(".group-timezones",o)
a.length&&a.each(((t,o)=>{const a=o.getAttribute("data-group")
if(!a)throw"[group] attribute is necessary when using timezones."
const d=(r.get("group_timezones")||{})[a]||[];(function(t,o){const r=new n.default("discourse-group-timezones",(0,s.getRegister)(e),o)
r.appendTo(t),i.push(r)})(o,{id:`${r.id}-${t}`,members:d,group:a,usersOnHoliday:e.container.lookup("service:site").users_on_holiday||[],size:o.getAttribute("data-size")||"medium"})}))}e.decorateCooked((function(t,s){if(s){const i=s.getModel()
i&&(e.preventCloak(i.id),o(t,i))}}),{id:"discourse-group-timezones"}),e.cleanupStream((function(){i.forEach((e=>e.cleanUp())),i=[]}))}))}}})),define("discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator",["exports","discourse/lib/environment","discourse/lib/plugin-api","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i,n,o,r,a,d,l){"use strict"
function u(e){e.innerHTML="",e.classList.add("discourse-post-event-preview")
const s=`discourse_post_event.models.event.status.${e.dataset.status||"public"}.title`
if(i.default.lookup(s,{locale:"en"})){const t=document.createElement("div")
t.classList.add("event-preview-status"),t.innerText=(0,i.i18n)(s),e.appendChild(t)}const n=document.createElement("div")
n.classList.add("event-preview-dates")
const o=moment.tz(e.dataset.start,e.dataset.timezone||"UTC"),a=e.dataset.end&&moment.tz(e.dataset.end,e.dataset.timezone||"UTC"),d=(0,r.default)(o,a),l=(0,t.isTesting)()?"UTC":moment.tz.guess()
let u=`<span class='start'>${o.tz(l).format(d)}</span>`
a&&(u+=` → <span class='end'>${a.tz(l).format(d)}</span>`),n.innerHTML=u,e.appendChild(n)}function c(e,t){t.querySelectorAll(".discourse-post-event").forEach(((e,t)=>{t>0?function(e){e.classList.add("discourse-post-event-preview","alert","alert-error"),e.classList.remove("discourse-post-event"),e.innerText=(0,i.i18n)("discourse_post_event.preview.more_than_one_event")}(e):u(e)}))}function p(e){e.decorateCookedElement(((e,t)=>{if(e.classList.contains("d-editor-preview"))c(0,e)
else if(t){const s=t.getModel()
if(!s?.event)return
const i=e.querySelector(".discourse-post-event")
if(!i)return
const r=document.createElement("div")
i.before(r)
const u=o.default.create(s.event)
t.renderGlimmer(r,(0,a.setComponentTemplate)((0,d.createTemplateFactory)({id:"QiC3s8Lf",block:'[[[8,[32,0],null,[["@event"],[[32,1]]],null]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator.js",scope:()=>[n.default,u],isStrictMode:!0}),(0,l.default)(void 0,void 0)))}}),{id:"discourse-post-event-decorator"}),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_auto_notification","calendar-day"),e.replaceIcon("notification.discourse_calendar.invite_user_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_predefined_attendance_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.before_event_reminder","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.after_event_reminder","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.ongoing_event_reminder","calendar-day")}Object.defineProperty(e,"__esModule",{value:!0}),e.buildEventPreview=u,e.default=void 0
e.default={name:"discourse-post-event-decorator",initialize(e){e.lookup("service:site-settings").discourse_post_event_enabled&&(0,s.withPluginApi)("0.8.7",p)}}})),define("discourse/plugins/discourse-calendar/discourse/initializers/event-relative-date",["exports","@ember/runloop","discourse/lib/environment","discourse/lib/later","discourse/plugins/discourse-calendar/discourse/lib/event-relative-date"],(function(e,t,s,i,n){"use strict"
function o(){document.querySelectorAll(".event-relative-date.topic-list").forEach((e=>(0,n.default)(e)))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"event-future-date",initialize(){o(),(0,s.isTesting)()||this._tick()},teardown(){this._interval&&((0,t.cancel)(this._interval),this._interval=null)},_tick(){this._interval&&(0,t.cancel)(this._interval),this._interval=(0,i.default)((()=>{o(),this._tick()}),6e4)}}})),define("discourse/plugins/discourse-calendar/discourse/lib/add-recurrent-events",["exports","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){try{return e.flatMap((e=>{const s=e.upcomingDates?.map((s=>t.default.create({name:e.name,post:e.post,category_id:e.categoryId,starts_at:s.starts_at,ends_at:s.ends_at})))||[]
return[e,...s]}))}catch(s){return console.error("Failed to retrieve events:",s),[]}}})),define("discourse/plugins/discourse-calendar/discourse/lib/calendar-locale",["exports","discourse-i18n"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.getCalendarButtonsText=function(){return{today:(0,t.i18n)("discourse_calendar.toolbar_button.today"),month:(0,t.i18n)("discourse_calendar.toolbar_button.month"),week:(0,t.i18n)("discourse_calendar.toolbar_button.week"),day:(0,t.i18n)("discourse_calendar.toolbar_button.day"),list:(0,t.i18n)("discourse_calendar.toolbar_button.list")}},e.getCurrentBcp47Locale=function(){return t.default.currentLocale().replace("_","-").toLowerCase()}})),define("discourse/plugins/discourse-calendar/discourse/lib/colors",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.colorToHex=function(e){let t="#"
for(let s=0;s<3;s++)t+=("00"+Math.round(e[s]).toString(16)).slice(-2)
return t},e.contrastColor=function(e){return(.2126*e[0]+.7152*e[1]+.0722*e[2])/255>=.5?"#000d":"#fffd"},e.stringToColor=function(e){let t=0
for(let i=0;i<e.length;i++)t=e.charCodeAt(i)+((t<<5)-t)
let s=[]
for(let i=0;i<3;i++){let e=t>>8*i&255
s.push(e)}return s}})),define("discourse/plugins/discourse-calendar/discourse/lib/discourse-markdown/discourse-calendar",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["div.calendar","div.discourse-calendar-header","div.discourse-calendar-wrap","select.discourse-calendar-timezone-picker","span.discourse-calendar-timezone-wrap","h2.discourse-calendar-title","div[data-calendar-type]","div[data-calendar-default-view]","div[data-calendar-default-timezone]","div[data-weekends]","div[data-hidden-days]","div.group-timezones","div[data-group]","div[data-size]"]),e.registerOptions(((e,t)=>{e.features["discourse-calendar-enabled"]=!!t.calendar_enabled})),e.registerPlugin((e=>{e.options.discourse.features["discourse-calendar-enabled"]&&(e.block.bbcode.ruler.push("discourse-calendar",t),e.block.bbcode.ruler.push("discourse-group-timezones",s))}))}
const t={tag:"calendar",before:function(e,t){e.push("div_calendar_wrap","div",1).attrs=[["class","discourse-calendar-wrap"]],e.push("div_calendar_header","div",1).attrs=[["class","discourse-calendar-header"]],e.push("h2_open","h2",1).attrs=[["class","discourse-calendar-title"]],e.push("h2_close","h2",-1),e.push("span_open","span",1).attrs=[["class","discourse-calendar-timezone-wrap"]],"true"===t.attrs.tzPicker&&function(e){const t=e.push("select_open","select",1)
t.attrs=[["class","discourse-calendar-timezone-picker"]],e.push("select_close","select",-1)}(e),e.push("span_close","span",-1),e.push("div_calendar_header","div",-1)
let s=e.push("div_calendar","div",1)
s.attrs=[["class","calendar"],["data-calendar-type",t.attrs.type||"dynamic"],["data-calendar-default-timezone",t.attrs.defaultTimezone]],t.attrs.defaultView&&s.attrs.push(["data-calendar-default-view",t.attrs.defaultView]),t.attrs.weekends&&s.attrs.push(["data-weekends",t.attrs.weekends]),t.attrs.showAddToCalendar&&s.attrs.push(["data-calendar-show-add-to-calendar","true"===t.attrs.showAddToCalendar]),t.attrs.fullDay&&s.attrs.push(["data-calendar-full-day","true"===t.attrs.fullDay]),t.attrs.hiddenDays&&s.attrs.push(["data-hidden-days",t.attrs.hiddenDays])},after:function(e){e.push("div_calendar","div",-1),e.push("div_calendar_wrap","div",-1)}},s={tag:"timezones",before:function(e,t){e.push("div_group_timezones","div",1).attrs=[["class","group-timezones"],["data-group",t.attrs.group],["data-size",t.attrs.size||"medium"]]},after:function(e){e.push("div_group_timezones","div",-1)}}})),define("discourse/plugins/discourse-calendar/discourse/lib/discourse-markdown/discourse-post-event-block",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["div.discourse-post-event"]),e.registerOptions(((e,t)=>{e.features.discourse_post_event=t.calendar_enabled&&t.discourse_post_event_enabled})),e.registerPlugin((e=>e.block.bbcode.ruler.push("discourse-post-event",t)))}
const t={tag:"event",wrap:(e,t)=>!!t.attrs.start&&(e.attrs=[["class","discourse-post-event"]],Object.keys(t.attrs).forEach((s=>{const i=t.attrs[s]
var n
void 0!==i&&e.attrs.push([`data-${n=s,n.replace(/[A-Z]/g,(function(e,t){return(0!==t?"-":"")+e.toLowerCase()}))}`,i])})),!0)}})),define("discourse/plugins/discourse-calendar/discourse/lib/event-relative-date",["exports","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){e.classList.remove("past","current","future"),e.innerHTML=""
const i=moment.utc(e.dataset.starts_at).tz(moment.tz.guess()),n=moment.utc(e.dataset.ends_at).tz(moment.tz.guess()),o=(0,s.default)(i)
let r=i.format(o)
n&&(r+=` → ${n.format(o)}`)
if(e.setAttribute("title",r),i.isAfter(moment())&&n.isAfter(moment()))return e.classList.add("future"),void function(e,t){e.innerText=t.from(moment())}(e,i)
if(i.isBefore(moment())&&n.isAfter(moment()))return e.classList.add("current"),void function(e,s){const i=document.createElement("div")
i.classList.add("indicator"),e.appendChild(i)
const n=document.createElement("span")
n.classList.add("text"),n.innerText=(0,t.i18n)("discourse_post_event.topic_title.ends_in_duration",{duration:s.from(moment())}),e.appendChild(n)}(e,n)
if(i.isBefore(moment())&&n.isBefore(moment()))return e.classList.add("past"),void function(e,t){e.innerText=t.from(moment())}(e,n)}})),define("discourse/plugins/discourse-calendar/discourse/lib/full-calendar-default-options",["exports","pretty-text/sanitizer","discourse/plugins/discourse-calendar/discourse/lib/calendar-locale","discourse/plugins/discourse-calendar/discourse/lib/popover"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return{eventClick:function(){(0,i.destroyPopover)()},locale:(0,s.getCurrentBcp47Locale)(),buttonText:(0,s.getCalendarButtonsText)(),eventMouseEnter:function(e){let{event:s,jsEvent:n}=e;(0,i.destroyPopover)()
const o=(0,t.escape)(s.title);(0,i.buildPopover)(n,o)},eventMouseLeave:function(){(0,i.destroyPopover)()}}}})),define("discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format",["exports"],(function(e){"use strict"
function t(e,t){return e.hours()>0||e.minutes()>0||t&&(moment(t).hours()>0||moment(t).minutes()>0)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,s){let i
i=t(e,s)?"LLL":"LL"
return i},e.isNotFullDayEvent=t})),define("discourse/plugins/discourse-calendar/discourse/lib/popover",["exports","@popperjs/core"],(function(e,t){"use strict"
let s
Object.defineProperty(e,"__esModule",{value:!0}),e.buildPopover=function(e,n){const o=document.createElement("div")
o.setAttribute("id",i),o.innerHTML=n
const r=document.createElement("span")
r.dataset.popperArrow=!0,o.appendChild(r),document.body.appendChild(o),s=(0,t.createPopper)(e.target,document.getElementById(i),{placement:"bottom",modifiers:[{name:"arrow"},{name:"offset",options:{offset:[20,10]}}]})},e.destroyPopover=function(){s?.destroy(),document.getElementById(i)?.remove()}
const i="event-popover"})),define("discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.buildParams=function(e,t,s,i){const n={},o=s.timezone||"UTC"
n.start=moment(e).tz(o).format("YYYY-MM-DD HH:mm"),s.isClosed&&(n.closed="true")
s.status&&(n.status=s.status)
s.name&&(n.name=s.name)
s.url&&(n.url=s.url)
s.timezone&&(n.timezone=s.timezone)
s.recurrence&&(n.recurrence=s.recurrence)
s.minimal&&(n.minimal="true")
t&&(n.end=moment(t).tz(o).format("YYYY-MM-DD HH:mm"))
"private"===s.status&&(n.allowedGroups=(s.rawInvitees||[]).join(","))
"public"===s.status&&(n.allowedGroups="trust_level_0")
s.reminders&&s.reminders.length&&(n.reminders=s.reminders.map((e=>{const t=Object.assign({},e)
return"after"===t.period&&(t.value=`-${Math.abs(parseInt(t.value,10))}`),"before"===t.period&&(t.value=Math.abs(parseInt(`${t.value}`,10))),`${t.type}.${t.value}.${t.unit}`})).join(","))
return i.discourse_post_event_allowed_custom_fields.split("|").filter(Boolean).forEach((e=>{const t=e.toLowerCase().replace(/-/g,"_").replace(/_(.)/g,(function(e,t){return t.toUpperCase()}))
void 0!==s.customFields[e]&&(n[t]=s.customFields[e])})),n},e.replaceRaw=function(e,t){const s=new RegExp("\\[event\\s(.*?)\\]","m"),i=t.match(s)
if(i&&i[1]){const i=[]
return Object.keys(e).forEach((t=>{const s=e[t]
s&&s.length&&i.push(`${t}="${e[t]}"`)})),t.replace(s,`[event ${i.join(" ")}]`)}return!1}})),define("discourse/plugins/discourse-calendar/discourse/lib/regions",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.TIME_ZONE_TO_REGION=e.HOLIDAY_REGIONS=void 0
e.HOLIDAY_REGIONS=["ae","ar","at","au","au_nsw","au_vic","au_qld","au_nt","au_act","au_sa","au_wa","au_tas","au_tas_south","au_qld_cairns","au_qld_brisbane","au_tas_north","au_vic_melbourne","be_fr","be_nl","br","br_spcapital","br_sp","bg_en","bg_bg","ca","ca_qc","ca_ab","ca_sk","ca_on","ca_bc","ca_nb","ca_mb","ca_ns","ca_pe","ca_nl","ca_nt","ca_nu","ca_yt","us","ch_zh","ch_be","ch_lu","ch_ur","ch_sz","ch_ow","ch_nw","ch_gl","ch_zg","ch_fr","ch_so","ch_bs","ch_bl","ch_sh","ch_ar","ch_ai","ch_sg","ch_gr","ch_ag","ch_tg","ch_ti","ch_vd","ch_ne","ch_ge","ch_ju","ch_vs","ch","cl","co","cr","cz","dk","de","de_bw","de_by","de_he","de_nw","de_rp","de_sl","de_sn_sorbian","de_th_cath","de_sn","de_st","de_be","de_by_cath","de_by_augsburg","de_bb","de_mv","de_th","de_hb","de_hh","de_ni","de_sh","ee","el","es_pv","es_na","es_an","es_ib","es_cm","es_mu","es_m","es_ar","es_cl","es_cn","es_lo","es_ga","es_ce","es_o","es_ex","es","es_ct","es_v","es_vc","fi","fr_a","fr_m","fr","gb","gb_eng","gb_wls","gb_eaw","gb_nir","je","gb_jsy","gg","gb_gsy","gb_sct","gb_con","im","gb_iom","ge","gh","hr","hk","hu","id","ie","in","in_gj","in_tn","in_ka","in_mh","in_rj","is","it","it_ve","it_tv","it_vr","it_pd","it_fi","it_ge","it_to","it_rm","it_vi","it_bl","it_ro","kr","kz","li","lt","lv","ma","mt_mt","mt_en","mx","mx_pue","nl","lu","no","nz","nz_sl","nz_we","nz_ak","nz_nl","nz_ne","nz_ot","nz_ta","nz_sc","nz_hb","nz_mb","nz_ca","nz_ch","nz_wl","pe","ph","pl","pt","pt_li","pt_po","ro","rs_cyrl","rs_la","ru","se","sa","tn","tr","ua","us_fl","us_la","us_ct","us_de","us_gu","us_hi","us_in","us_ky","us_nj","us_nc","us_nd","us_pr","us_tn","us_ms","us_id","us_ar","us_tx","us_dc","us_md","us_va","us_vt","us_ak","us_ca","us_me","us_ma","us_al","us_ga","us_ne","us_mo","us_sc","us_wv","us_vi","us_ut","us_ri","us_az","us_co","us_oh","us_or","us_sd","us_wy","us_nv","us_mt","us_ny","us_pa","us_nm","us_ia","us_il","us_ks","us_mi","us_mn","us_nh","us_ok","us_wa","us_wi","za","ve","sk","si","jp","vi","sg","my","th","ng","ke"],e.TIME_ZONE_TO_REGION={"Africa/Accra":"gh","Africa/Casablanca":"ma","Africa/Ceuta":"es","Africa/Johannesburg":"za","Africa/Lagos":"ng","Africa/Nairobi":"ke","Africa/Tunis":"tn","America/Adak":"us","America/Anchorage":"us","America/Araguaina":"br","America/Argentina/Buenos_Aires":"ar","America/Argentina/Catamarca":"ar","America/Argentina/Cordoba":"ar","America/Argentina/Jujuy":"ar","America/Argentina/La_Rioja":"ar","America/Argentina/Mendoza":"ar","America/Argentina/Rio_Gallegos":"ar","America/Argentina/Salta":"ar","America/Argentina/San_Juan":"ar","America/Argentina/San_Luis":"ar","America/Argentina/Tucuman":"ar","America/Argentina/Ushuaia":"ar","America/Atikokan":"ca","America/Bahia":"br","America/Bahia_Banderas":"mx","America/Belem":"br","America/Blanc-Sablon":"ca","America/Boa_Vista":"br","America/Bogota":"co","America/Boise":"us","America/Cambridge_Bay":"ca","America/Campo_Grande":"br","America/Cancun":"mx","America/Caracas":"ve","America/Chicago":"us","America/Chihuahua":"mx","America/Ciudad_Juarez":"mx","America/Costa_Rica":"cr","America/Creston":"ca","America/Cuiaba":"br","America/Dawson":"ca","America/Dawson_Creek":"ca","America/Denver":"us","America/Detroit":"us","America/Edmonton":"ca","America/Eirunepe":"br","America/Fort_Nelson":"ca","America/Fortaleza":"br","America/Glace_Bay":"ca","America/Goose_Bay":"ca","America/Halifax":"ca","America/Hermosillo":"mx","America/Indiana/Indianapolis":"us","America/Indiana/Knox":"us","America/Indiana/Marengo":"us","America/Indiana/Petersburg":"us","America/Indiana/Tell_City":"us","America/Indiana/Vevay":"us","America/Indiana/Vincennes":"us","America/Indiana/Winamac":"us","America/Inuvik":"ca","America/Iqaluit":"ca","America/Juneau":"us","America/Kentucky/Louisville":"us","America/Kentucky/Monticello":"us","America/Lima":"pe","America/Los_Angeles":"us","America/Maceio":"br","America/Manaus":"br","America/Matamoros":"mx","America/Mazatlan":"mx","America/Menominee":"us","America/Merida":"mx","America/Metlakatla":"us","America/Mexico_City":"mx","America/Moncton":"ca","America/Monterrey":"mx","America/New_York":"us","America/Nome":"us","America/Noronha":"br","America/North_Dakota/Beulah":"us","America/North_Dakota/Center":"us","America/North_Dakota/New_Salem":"us","America/Ojinaga":"mx","America/Phoenix":"us","America/Porto_Velho":"br","America/Punta_Arenas":"cl","America/Rankin_Inlet":"ca","America/Recife":"br","America/Regina":"ca","America/Resolute":"ca","America/Rio_Branco":"br","America/Santarem":"br","America/Santiago":"cl","America/Sao_Paulo":"br","America/Sitka":"us","America/St_Johns":"ca","America/St_Thomas":"vi","America/Swift_Current":"ca","America/Tijuana":"mx","America/Toronto":"ca","America/Vancouver":"ca","America/Whitehorse":"ca","America/Winnipeg":"ca","America/Yakutat":"us","Antarctica/Macquarie":"au","Asia/Almaty":"kz","Asia/Anadyr":"ru","Asia/Aqtau":"kz","Asia/Aqtobe":"kz","Asia/Atyrau":"kz","Asia/Bangkok":"th","Asia/Barnaul":"ru","Asia/Chita":"ru","Asia/Dubai":"ae","Asia/Hong_Kong":"hk","Asia/Irkutsk":"ru","Asia/Jakarta":"id","Asia/Jayapura":"id","Asia/Kamchatka":"ru","Asia/Khandyga":"ru","Asia/Kolkata":"in","Asia/Krasnoyarsk":"ru","Asia/Kuala_Lumpur":"my","Asia/Kuching":"my","Asia/Magadan":"ru","Asia/Makassar":"id","Asia/Manila":"ph","Asia/Novokuznetsk":"ru","Asia/Novosibirsk":"ru","Asia/Omsk":"ru","Asia/Oral":"kz","Asia/Pontianak":"id","Asia/Qostanay":"kz","Asia/Qyzylorda":"kz","Asia/Riyadh":"sa","Asia/Sakhalin":"ru","Asia/Seoul":"kr","Asia/Singapore":"sg","Asia/Srednekolymsk":"ru","Asia/Tbilisi":"ge","Asia/Tokyo":"jp","Asia/Tomsk":"ru","Asia/Ust-Nera":"ru","Asia/Vladivostok":"ru","Asia/Yakutsk":"ru","Asia/Yekaterinburg":"ru","Atlantic/Azores":"pt","Atlantic/Canary":"es","Atlantic/Madeira":"pt","Atlantic/Reykjavik":"is","Australia/Adelaide":"au","Australia/Brisbane":"au","Australia/Broken_Hill":"au","Australia/Darwin":"au","Australia/Eucla":"au","Australia/Hobart":"au","Australia/Lindeman":"au","Australia/Lord_Howe":"au","Australia/Melbourne":"au","Australia/Perth":"au","Australia/Sydney":"au","Europe/Amsterdam":"nl","Europe/Astrakhan":"ru","Europe/Athens":"el","Europe/Berlin":"de","Europe/Bratislava":"sk","Europe/Bucharest":"ro","Europe/Budapest":"hu","Europe/Busingen":"de","Europe/Copenhagen":"dk","Europe/Dublin":"ie","Europe/Guernsey":"gg","Europe/Helsinki":"fi","Europe/Isle_of_Man":"im","Europe/Istanbul":"tr","Europe/Jersey":"je","Europe/Kaliningrad":"ru","Europe/Kirov":"ru","Europe/Kyiv":"ua","Europe/Lisbon":"pt","Europe/Ljubljana":"si","Europe/London":"gb","Europe/Luxembourg":"lu","Europe/Madrid":"es","Europe/Moscow":"ru","Europe/Oslo":"no","Europe/Paris":"fr","Europe/Prague":"cz","Europe/Riga":"lv","Europe/Rome":"it","Europe/Samara":"ru","Europe/Saratov":"ru","Europe/Simferopol":"ru","Europe/Stockholm":"se","Europe/Tallinn":"ee","Europe/Ulyanovsk":"ru","Europe/Vaduz":"li","Europe/Vienna":"at","Europe/Vilnius":"lt","Europe/Volgograd":"ru","Europe/Warsaw":"pl","Europe/Zagreb":"hr","Europe/Zurich":"ch","Pacific/Auckland":"nz","Pacific/Chatham":"nz","Pacific/Easter":"cl","Pacific/Honolulu":"us"}})),define("discourse/plugins/discourse-calendar/discourse/lib/round-time",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){return e.round(t,"minutes")},"function"!=typeof moment.fn.round&&(moment.fn.round=function(e,t,s){s=s||"round"
let i,n=this,o={hours:{name:"Hours",maxValue:24},minutes:{name:"Minutes",maxValue:60},seconds:{name:"Seconds",maxValue:60},milliseconds:{name:"Milliseconds",maxValue:1e3}},r={mm:o.milliseconds.name,milliseconds:o.milliseconds.name,Milliseconds:o.milliseconds.name,s:o.seconds.name,seconds:o.seconds.name,Seconds:o.seconds.name,m:o.minutes.name,minutes:o.minutes.name,Minutes:o.minutes.name,H:o.hours.name,h:o.hours.name,hours:o.hours.name,Hours:o.hours.name},a=0,d=!1,l=1
if(t.length>1&&"mm"!==t&&"s"!==t.slice(-1)&&(t+="s"),!o[t=r[t].toLowerCase()])throw new Error('The value to round is not valid. Possibles ["hours", "minutes", "seconds", "milliseconds"]')
let u="get"+o[t].name,c="set"+o[t].name
for(let p in o)p===t?(a=n._d[u](),i=o[p].maxValue,d=!0):d&&(l*=o[p].maxValue,a+=n._d["get"+o[p].name]()/l,n._d["set"+o[p].name](0))
return a=Math[s](a/e)*e,a=Math.min(a,i),n._d[c](a),n}),"function"!=typeof moment.fn.ceil&&(moment.fn.ceil=function(e,t){return this.round(e,t,"ceil")}),"function"!=typeof moment.fn.floor&&(moment.fn.floor=function(e,t){return this.round(e,t,"floor")})
const t=15}))
define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event-stats",["exports","@glimmer/tracking"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s{static create(){return new s(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"going",[t.tracked],(function(){return 0})))()
#Y=(()=>{dt7948.i(this,"going")})()
static#t=(()=>dt7948.g(this.prototype,"interested",[t.tracked],(function(){return 0})))()
#H=(()=>{dt7948.i(this,"interested")})()
static#o=(()=>dt7948.g(this.prototype,"invited",[t.tracked],(function(){return 0})))()
#W=(()=>{dt7948.i(this,"invited")})()
static#r=(()=>dt7948.g(this.prototype,"notGoing",[t.tracked],(function(){return 0})))()
#q=(()=>{dt7948.i(this,"notGoing")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.going=e.going,this.invited=e.invited,this.interested=e.interested,this.notGoing=e.not_going}}e.default=s})),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event",["exports","@glimmer/tracking","@ember/object","@ember-compat/tracked-built-ins","discourse/lib/decorators","discourse/models/user","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event-stats","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee"],(function(e,t,s,i,n,o,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d={type:"notification",value:15,unit:"minutes",period:"before"}
class l{static create(){return new l(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"title",[t.tracked]))()
#G=(()=>{dt7948.i(this,"title")})()
static#t=(()=>dt7948.g(this.prototype,"name",[t.tracked]))()
#V=(()=>{dt7948.i(this,"name")})()
static#o=(()=>dt7948.g(this.prototype,"categoryId",[t.tracked]))()
#K=(()=>{dt7948.i(this,"categoryId")})()
static#r=(()=>dt7948.g(this.prototype,"startsAt",[t.tracked]))()
#C=(()=>{dt7948.i(this,"startsAt")})()
static#p=(()=>dt7948.g(this.prototype,"endsAt",[t.tracked]))()
#O=(()=>{dt7948.i(this,"endsAt")})()
static#v=(()=>dt7948.g(this.prototype,"rawInvitees",[t.tracked]))()
#Z=(()=>{dt7948.i(this,"rawInvitees")})()
static#g=(()=>dt7948.g(this.prototype,"url",[t.tracked]))()
#J=(()=>{dt7948.i(this,"url")})()
static#f=(()=>dt7948.g(this.prototype,"timezone",[t.tracked]))()
#Q=(()=>{dt7948.i(this,"timezone")})()
static#_=(()=>dt7948.g(this.prototype,"status",[t.tracked]))()
#X=(()=>{dt7948.i(this,"status")})()
static#b=(()=>dt7948.g(this.prototype,"post",[t.tracked]))()
#ee=(()=>{dt7948.i(this,"post")})()
static#y=(()=>dt7948.g(this.prototype,"minimal",[t.tracked]))()
#te=(()=>{dt7948.i(this,"minimal")})()
static#w=(()=>dt7948.g(this.prototype,"canUpdateAttendance",[t.tracked]))()
#se=(()=>{dt7948.i(this,"canUpdateAttendance")})()
static#A=(()=>dt7948.g(this.prototype,"canActOnDiscoursePostEvent",[t.tracked]))()
#ie=(()=>{dt7948.i(this,"canActOnDiscoursePostEvent")})()
static#k=(()=>dt7948.g(this.prototype,"shouldDisplayInvitees",[t.tracked]))()
#ne=(()=>{dt7948.i(this,"shouldDisplayInvitees")})()
static#E=(()=>dt7948.g(this.prototype,"isClosed",[t.tracked]))()
#oe=(()=>{dt7948.i(this,"isClosed")})()
static#x=(()=>dt7948.g(this.prototype,"isExpired",[t.tracked]))()
#re=(()=>{dt7948.i(this,"isExpired")})()
static#M=(()=>dt7948.g(this.prototype,"isStandalone",[t.tracked]))()
#ae=(()=>{dt7948.i(this,"isStandalone")})()
static#z=(()=>dt7948.g(this.prototype,"recurrence",[t.tracked]))()
#de=(()=>{dt7948.i(this,"recurrence")})()
static#S=(()=>dt7948.g(this.prototype,"recurrenceRule",[t.tracked]))()
#le=(()=>{dt7948.i(this,"recurrenceRule")})()
static#ue=(()=>dt7948.g(this.prototype,"customFields",[t.tracked]))()
#ce=(()=>{dt7948.i(this,"customFields")})()
static#pe=(()=>dt7948.g(this.prototype,"_watchingInvitee",[t.tracked]))()
#me=(()=>{dt7948.i(this,"_watchingInvitee")})()
static#ve=(()=>dt7948.g(this.prototype,"_sampleInvitees",[t.tracked]))()
#ge=(()=>{dt7948.i(this,"_sampleInvitees")})()
static#he=(()=>dt7948.g(this.prototype,"_stats",[t.tracked]))()
#fe=(()=>{dt7948.i(this,"_stats")})()
static#_e=(()=>dt7948.g(this.prototype,"_creator",[t.tracked]))()
#be=(()=>{dt7948.i(this,"_creator")})()
static#ye=(()=>dt7948.g(this.prototype,"_reminders",[t.tracked]))()
#we=(()=>{dt7948.i(this,"_reminders")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.id=e.id,this.name=e.name,this.categoryId=e.category_id,this.upcomingDates=e.upcoming_dates,this.startsAt=e.starts_at,this.endsAt=e.ends_at,this.rawInvitees=e.raw_invitees,this.sampleInvitees=e.sample_invitees||[],this.url=e.url,this.timezone=e.timezone,this.status=e.status,this.creator=e.creator,this.post=e.post,this.isClosed=e.is_closed,this.isExpired=e.is_expired,this.isStandalone=e.is_standalone,this.minimal=e.minimal,this.recurrenceRule=e.recurrence_rule,this.recurrence=e.recurrence,this.canUpdateAttendance=e.can_update_attendance,this.canActOnDiscoursePostEvent=e.can_act_on_discourse_post_event,this.shouldDisplayInvitees=e.should_display_invitees,this.watchingInvitee=e.watching_invitee,this.stats=e.stats,this.reminders=e.reminders,this.customFields=s.default.create(e.custom_fields||{})}get watchingInvitee(){return this._watchingInvitee}set watchingInvitee(e){this._watchingInvitee=e?a.default.create(e):null}get sampleInvitees(){return this._sampleInvitees}set sampleInvitees(e){void 0===e&&(e=[]),this._sampleInvitees=new i.TrackedArray(e.map((e=>a.default.create(e))))}get stats(){return this._stats}set stats(e){this._stats=this.#Ae(e)}get reminders(){return this._reminders}set reminders(e){void 0===e&&(e=[]),this._reminders=new i.TrackedArray(e)}get creator(){return this._creator}set creator(e){this._creator=this.#ke(e)}get isPublic(){return"public"===this.status}get isPrivate(){return"private"===this.status}updateFromEvent(e){this.name=e.name,this.startsAt=e.startsAt,this.endsAt=e.endsAt,this.url=e.url,this.timezone=e.timezone,this.status=e.status,this.creator=e.creator,this.isClosed=e.isClosed,this.isExpired=e.isExpired,this.isStandalone=e.isStandalone,this.minimal=e.minimal,this.recurrenceRule=e.recurrenceRule,this.recurrence=e.recurrence,this.canUpdateAttendance=e.canUpdateAttendance,this.canActOnDiscoursePostEvent=e.canActOnDiscoursePostEvent,this.shouldDisplayInvitees=e.shouldDisplayInvitees,this.stats=e.stats,this.sampleInvitees=e.sampleInvitees||[],this.reminders=e.reminders}removeReminder(e){const t=this.reminders.findIndex((t=>t.id===e.id))
t>-1&&this.reminders.splice(t,1)}static#Ee=(()=>dt7948.n(this.prototype,"removeReminder",[n.bind]))()
addReminder(e){e??={...d},this.reminders.push(e)}static#xe=(()=>dt7948.n(this.prototype,"addReminder",[n.bind]))()
#ke(e){return!e||e instanceof o.default?e:o.default.create(e)}#Ae(e){return!e||e instanceof r.default?e:r.default.create(e)}}e.default=l})),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee",["exports","@glimmer/tracking","discourse/models/user"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i{static create(){return new i(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"status",[t.tracked]))()
#X=(()=>{dt7948.i(this,"status")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.id=e.id,this.post_id=e.post_id,this.status=e.status,this.user=this.#ke(e.user)}#ke(e){return!e||e instanceof s.default?e:s.default.create(e)}}e.default=i})),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitees",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/models/user","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o{static create(){return new o(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"_invitees",[t.tracked]))()
#Me=(()=>{dt7948.i(this,"_invitees")})()
static#t=(()=>dt7948.g(this.prototype,"_suggestedUsers",[t.tracked]))()
#ze=(()=>{dt7948.i(this,"_suggestedUsers")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.invitees=e.invitees||[],this.suggestedUsers=e.meta?.suggested_users||[]}get invitees(){return this._invitees}set invitees(e){void 0===e&&(e=[]),this._invitees=new s.TrackedArray(e.map((e=>n.default.create(e))))}get suggestedUsers(){return this._suggestedUsers}set suggestedUsers(e){void 0===e&&(e=[]),this._suggestedUsers=new s.TrackedArray(e.map((e=>i.default.create(e))))}add(e){this.invitees.push(e),this.suggestedUsers=this.suggestedUsers.filter((t=>t.id!==e.user.id))}remove(e){this.invitees=this.invitees.filter((t=>t.user.id!==e.user.id))}}e.default=o})),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-reminder",["exports","discourse/models/rest"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{init(){super.init(...arguments),this.__type="discourse-post-event-reminder"}}e.default=s})),define("discourse/plugins/discourse-calendar/discourse/pre-initializers/rich-editor-extension",["exports","@ember/string","discourse/lib/plugin-api","discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n={nodeSpec:{event:{attrs:{name:{default:null},start:{default:null},end:{default:null},reminders:{default:null},minimal:{default:null},closed:{default:null},status:{default:"public"},timezone:{default:"UTC"},allowedGroups:{default:null}},group:"block",defining:!0,isolating:!0,draggable:!0,parseDOM:[{tag:"div.discourse-post-event",getAttrs:e=>({...e.dataset})}],toDOM(e){const t=document.createElement("div")
t.classList.add("discourse-post-event")
for(const[s,i]of Object.entries(e.attrs))null!==i&&(t.dataset[s]=i)
return(0,i.buildEventPreview)(t),t}}},parse:{wrap_bbcode(e,s){if("div"===s.tag){if(-1===s.nesting&&"event"===e.top().type.name)return e.closeNode(),!0
if(1===s.nesting&&"discourse-post-event"===s.attrGet("class")){const i=Object.fromEntries(s.attrs.filter((e=>{let[t]=e
return t.startsWith("data-")})).map((e=>{let[s,i]=e
return[(0,t.camelize)(s.slice(5)),i]})))
return e.openNode(e.schema.nodes.event,i),!0}}return!1}},serializeNode:{event(e,t){let s="[event"
Object.entries(t.attrs).forEach((e=>{let[t,i]=e
null!==i&&(s+=` ${t}="${i}"`)})),s+="]\n[/event]\n",e.write(s)}}}
e.default={initialize(){(0,s.withPluginApi)("2.1.1",(e=>{e.registerRichEditorExtension(n)}))}}})),define("discourse/plugins/discourse-calendar/discourse/pre-initializers/transformers",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={before:"freeze-valid-transformers",initialize(){(0,t.withPluginApi)("1.33.0",(e=>{e.addValueTransformerName("discourse-calendar-event-more-menu-should-show-participants")}))}}})),define("discourse/plugins/discourse-calendar/discourse/routes/discourse-post-event-upcoming-events-index",["exports","@ember/object","@ember/service","discourse/lib/url","discourse/routes/discourse"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends n.default{static#e=(()=>dt7948.g(this.prototype,"discoursePostEventApi",[s.service]))()
#d=(()=>{dt7948.i(this,"discoursePostEventApi")})()
static#t=(()=>dt7948.g(this.prototype,"discoursePostEventService",[s.service]))()
#Se=(()=>{dt7948.i(this,"discoursePostEventService")})()
activate(){this.siteSettings.discourse_post_event_enabled||i.default.redirectTo("/404")}static#o=(()=>dt7948.n(this.prototype,"activate",[t.action]))()
async model(e){return await this.discoursePostEventService.fetchEvents(e)}}e.default=o})),define("discourse/plugins/discourse-calendar/discourse/services/discourse-post-event-api",["exports","@ember/service","discourse/lib/ajax","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitees"],(function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{async event(e){const t=await this.#Pe(`/events/${e}`)
return i.default.create(t.event)}async events(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return(await this.#Pe("/events",e)).events.map((e=>i.default.create(e)))}async listEventInvitees(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const s=await this.#Pe(`/events/${e.id}/invitees`,t)
return o.default.create(s)}async updateEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const s=await this.#Te(`/events/${e.id}`,{event:t})
return e.updateFromEvent(s),e}async updateEventAttendance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
if(!e.watchingInvitee)return
const s=await this.#Te(`/events/${e.id}/invitees/${e.watchingInvitee.id}`,{invitee:t})
return e.watchingInvitee=n.default.create(s.invitee),e.sampleInvitees.forEach((t=>{t.id===e.watchingInvitee.id&&(t.status=e.watchingInvitee.status)})),e.stats=s.invitee.meta.event_stats,e.shouldDisplayInvitees=s.invitee.meta.event_should_display_invitees,e}async leaveEvent(e,t){await this.#je(`/events/${e.id}/invitees/${t.id}`),e.sampleInvitees=e.sampleInvitees.filter((e=>e.id!==t.id)),e.watchingInvitee?.id===t.id&&(e.watchingInvitee=null)}async joinEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const s=await this.#Ce(`/events/${e.id}/invitees`,{invitee:t}),i=n.default.create(s.invitee)
return t.user_id||(e.watchingInvitee=i,e.sampleInvitees.push(e.watchingInvitee)),e.stats=s.invitee.meta.event_stats,e.shouldDisplayInvitees=s.invitee.meta.event_should_display_invitees,i}get#Oe(){return"/discourse-post-event"}#Pe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Oe}${e}`,{type:"GET",data:t})}#Te(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Oe}${e}`,{type:"PUT",data:t})}#Ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Oe}${e}`,{type:"POST",data:t})}#je(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Oe}${e}`,{type:"DELETE",data:t})}}e.default=r})),define("discourse/plugins/discourse-calendar/discourse/services/discourse-post-event-service",["exports","@ember/service"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[t.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#t=(()=>dt7948.g(this.prototype,"discoursePostEventApi",[t.service]))()
#d=(()=>{dt7948.i(this,"discoursePostEventApi")})()
async fetchEvents(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.siteSettings.include_expired_events_on_calendar&&(e.include_expired=!0)
const t=await this.discoursePostEventApi.events(e)
return await t}}e.default=s})),define("discourse/plugins/discourse-calendar/discourse/templates/admin-plugins-calendar",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"K7zHArtP",block:'[[[10,"h3"],[12],[1,"\\n  "],[1,[28,[35,1],["discourse_calendar.holidays.header_title"],null]],[1,"\\n"],[13],[1,"\\n\\n"],[8,[39,2],null,[["@value","@onChange"],[[30,0,["selectedRegion"]],[28,[37,3],[[30,0],"getHolidays"],null]]],null],[1,"\\n\\n"],[10,2],[14,0,"desc"],[12],[1,"\\n  "],[1,[28,[35,1],["discourse_calendar.holidays.pick_region_description"],null]],[1,"\\n  "],[10,"br"],[12],[13],[10,"br"],[12],[13],[1,"\\n  "],[1,[28,[35,1],["discourse_calendar.holidays.disabled_holidays_description"],null]],[1,"\\n"],[13],[1,"\\n\\n"],[8,[39,6],null,[["@condition"],[[30,0,["loading"]]]],null],[1,"\\n\\n"],[41,[30,0,["model","holidays"]],[[[1,"  "],[8,[39,8],null,[["@holidays","@region_code"],[[30,0,["model","holidays"]],[30,0,["selectedRegion"]]]],null],[1,"\\n"]],[]],null]],[],false,["h3","i18n","region-input","action","p","br","conditional-loading-spinner","if","admin-holidays-list"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/templates/admin-plugins-calendar.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events-index",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"sNuG7G0z",block:'[[[10,0],[14,0,"discourse-post-event-upcoming-events"],[12],[1,"\\n  "],[8,[39,1],null,[["@events"],[[30,0,["model"]]]],null],[1,"\\n"],[13]],[],false,["div","upcoming-events-calendar"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events-index.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"+Rik5RgH",block:'[[[46,[28,[37,1],null,null],null,null,null]],[],false,["component","-outlet"]]',moduleName:"discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events.hbs",isStrictMode:!1})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezone-new-day",["exports","discourse/widgets/widget"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createWidget)("discourse-group-timezone-new-day",{tagName:"div.group-timezone-new-day",template:function(e,t){var s=__widget_helpers.iconNode,i=[]
i.push("\n    ")
var n=[]
n.push("\n      "),n.push(s("chevron-left")),n.push("\n      "),n.push(this.attrs.groupedTimezone.beforeDate),n.push("\n    "),i.push(virtualDom.h("span",{className:"before",attributes:{}},n)),i.push("\n    ")
var o=[]
return o.push("\n      "),o.push(this.attrs.groupedTimezone.afterDate),o.push("\n      "),o.push(s("chevron-right")),o.push("\n    "),i.push(virtualDom.h("span",{className:"after",attributes:{}},o)),i.push("\n  "),i}})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezone",["exports","discourse/widgets/widget"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createWidget)("discourse-group-timezone",{tagName:"div.group-timezone",buildClasses(e){const t=[]
return e.groupedTimezone.closeToWorkingHours&&t.push("close-to-working-hours"),e.groupedTimezone.inWorkingHours&&t.push("in-working-hours"),t.join(" ")},transform:e=>({formatedTime:e.groupedTimezone.nowWithOffset.format("LT")}),template:function(e,t){var s=__widget_helpers.rawHtml,i=[]
i.push("\n    ")
var n=[]
n.push("\n      ")
var o=[]
o.push("\n        "),o.push(this.transformed.formatedTime),o.push("\n      "),n.push(virtualDom.h("span",{className:"time",attributes:{}},o)),n.push("\n      ")
var r=[]
r.push("\n        "),r.push(new s({html:"<span>"+e.groupedTimezone.utcOffset+"</span>"})),r.push("\n      "),n.push(virtualDom.h("span",{className:"offset",attributes:{title:"UTC offset"}},r)),n.push("\n    "),i.push(virtualDom.h("div",{className:"info",attributes:{}},n)),i.push("\n    ")
var a=[]
return a.push("\n"),e.groupedTimezone.members&&e.groupedTimezone.members.length&&e.groupedTimezone.members.forEach((t=>{a.push("        "),a.push(this.attach("discourse-group-timezones-member",{usersOnHoliday:e.usersOnHoliday,member:t},void 0,void 0)),a.push("\n")})),a.push("    "),i.push(virtualDom.h("ul",{className:"group-timezones-members",attributes:{}},a)),i.push("\n  "),i}})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezones-filter",["exports","@ember/runloop","discourse/widgets/widget","discourse-i18n"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,s.createWidget)("discourse-group-timezones-filter",{tagName:"input.group-timezones-filter",input(e){this.changeFilterThrottler(e.target.value)},changeFilterThrottler(e){(0,t.throttle)(this,(function(){this.sendWidgetAction("onChangeFilter",e)}),100)},buildAttributes:()=>({type:"text",placeholder:(0,i.i18n)("group_timezones.search")})})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezones-header",["exports","discourse/widgets/widget","discourse-i18n"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createWidget)("discourse-group-timezones-header",{tagName:"div.group-timezones-header",transform:e=>({title:(0,s.i18n)("group_timezones.group_availability",{group:e.group})}),template:function(e,t){var s=[]
s.push("\n    "),s.push(this.attach("discourse-group-timezones-time-traveler",{id:e.id,localTimeOffset:e.localTimeOffset},void 0,void 0)),s.push("\n    ")
var i=[]
return i.push("\n      "),i.push(this.transformed.title),i.push("\n    "),s.push(virtualDom.h("span",{className:"title",attributes:{}},i)),s.push("\n    "),s.push(this.attach("discourse-group-timezones-filter",void 0,void 0,void 0)),s.push("\n  "),s}})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezones-member",["exports","virtual-dom","discourse/lib/utilities","discourse/widgets/post","discourse/widgets/widget"],(function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,n.createWidget)("discourse-group-timezones-member",{tagName:"li.group-timezones-member",buildClasses:e=>e.member.on_holiday?"on-holiday":"not-on-holiday",html(e){const{name:n,username:o,avatar_template:r}=e.member
return(0,t.h)("a",{attributes:{class:"group-timezones-member-avatar","data-user-card":o}},(0,i.avatarImg)("small",{template:r,username:n||(0,s.formatUsername)(o)}))}})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezones-reset",["exports","discourse/widgets/widget"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createWidget)("discourse-group-timezones-reset",{tagName:"div.group-timezones-reset",onResetOffset(){this.sendWidgetAction("onChangeCurrentUserTimeOffset",0)
const e=document.getElementById(this.attrs.id).querySelector("input[type=range].group-timezones-slider")
e&&(e.value=0)},transform:e=>({isDisabled:0===e.localTimeOffset}),template:function(e,t){var s=[]
return s.push("\n    "),s.push(this.attach("button",{disabled:this.transformed.isDisabled,action:"onResetOffset",icon:"arrow-rotate-left"},void 0,void 0)),s.push("\n  "),s}})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezones-slider",["exports","@ember/runloop","discourse/widgets/widget"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,s.createWidget)("discourse-group-timezones-slider",{tagName:"input.group-timezones-slider",input(e){this._handleSliderEvent(e)},change(e){this._handleSliderEvent(e)},changeOffsetThrottler(e){(0,t.throttle)(this,(function(){this.sendWidgetAction("onChangeCurrentUserTimeOffset",e)}),75)},buildAttributes:()=>({step:1,value:0,min:-48,max:48,type:"range"}),_handleSliderEvent(e){const t=15*parseInt(e.target.value,10)
this.changeOffsetThrottler(t)}})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezones-time-traveler",["exports","discourse/widgets/widget","discourse/plugins/discourse-calendar/discourse/lib/round-time"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createWidget)("discourse-group-timezones-time-traveler",{tagName:"div.group-timezones-time-traveler",transform(e){let t=moment().add(e.localTimeOffset,"minutes")
return e.localTimeOffset&&(t=(0,s.default)(t)),{localTimeWithOffset:t.format("HH:mm")}},template:function(e,t){var s=[]
s.push("\n    ")
var i=[]
i.push("\n      "),i.push(this.transformed.localTimeWithOffset),i.push("\n    "),s.push(virtualDom.h("span",{className:"time",attributes:{}},i)),s.push("\n    ")
var n=[]
return n.push("\n      "),n.push(this.attach("discourse-group-timezones-slider",void 0,void 0,void 0)),n.push("\n    "),s.push(virtualDom.h("span",{className:"discourse-group-timezones-slider-wrapper",attributes:{}},n)),s.push("\n    "),s.push(this.attach("discourse-group-timezones-reset",{id:e.id,localTimeOffset:e.localTimeOffset},void 0,void 0)),s.push("\n  "),s}})})),define("discourse/plugins/discourse-calendar/discourse/widgets/discourse-group-timezones",["exports","discourse/widgets/widget","discourse/plugins/discourse-calendar/discourse/lib/round-time"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createWidget)("discourse-group-timezones",{tagName:"div.group-timezones",buildKey:e=>`group-timezones-${e.id}`,buildClasses:e=>e.size,buildAttributes:e=>({id:e.id}),defaultState:()=>({localTimeOffset:0}),onChangeCurrentUserTimeOffset(e){this.state.localTimeOffset=e},transform(e,t){const s=e.members||[]
let i,n=[]
return s.filterBy("timezone").forEach((e=>{if(this._shouldAddMemberToGroup(this.state.filter,e)){const s=e.timezone,i=parseInt(moment.tz(s).format("YYYYMDHm"),10)
let o=n.findBy("identifier",i)
if(o)o.members.push(e)
else{const r=this._roundMoment(moment.tz(s)),a=this._workingDays(),d=moment.tz(moment.utc(),s).utcOffset()
o={identifier:i,offset:d,type:"discourse-group-timezone",nowWithOffset:r.add(t.localTimeOffset,"minutes"),closeToWorkingHours:this._closeToWorkingHours(r,a),inWorkingHours:this._inWorkingHours(r,a),utcOffset:this._utcOffset(d),members:[e]},n.push(o)}}})),n=n.sortBy("offset").filter((e=>e.members.length)),n.forEach(((e,t)=>{t>0&&n[t-1].nowWithOffset.format("dddd")!==e.nowWithOffset.format("dddd")&&(i=t)})),i&&n.splice(i,0,{type:"discourse-group-timezone-new-day",beforeDate:n[i-1].nowWithOffset.format("dddd"),afterDate:n[i].nowWithOffset.format("dddd")}),{groupedTimezones:n}},onChangeFilter(e){this.state.filter=e&&e.length?e:null},template:function(e,t){var s=[]
s.push("\n    "),s.push(this.attach("discourse-group-timezones-header",{id:e.id,group:e.group,localTimeOffset:t.localTimeOffset},void 0,void 0)),s.push("\n    ")
var i=[]
return i.push("\n"),this.transformed.groupedTimezones&&this.transformed.groupedTimezones.length&&this.transformed.groupedTimezones.forEach((t=>{i.push("        "),i.push(this.attach(t.type,{usersOnHoliday:e.usersOnHoliday,groupedTimezone:t},void 0,void 0)),i.push("\n")})),i.push("    "),s.push(virtualDom.h("div",{className:"group-timezones-body",attributes:{}},i)),s.push("\n  "),s},_shouldAddMemberToGroup:(e,t)=>!e||(e=e.toLowerCase(),!!(t.username.toLowerCase().indexOf(e)>-1||t.name&&t.name.toLowerCase().indexOf(e)>-1)),_roundMoment(e){return this.state.localTimeOffset&&(e=(0,s.default)(e)),e},_closeToWorkingHours(e,t){const s=e.hours(),i=this.siteSettings.working_day_start_hour,n=this.siteSettings.working_day_end_hour,o=this.siteSettings.close_to_working_day_hours_extension
return(s>=Math.max(i-o,0)&&s<=i||s<=Math.min(n+o,23)&&s>=n)&&t.includes(e.isoWeekday())},_inWorkingHours(e,t){const s=e.hours()
return s>this.siteSettings.working_day_start_hour&&s<this.siteSettings.working_day_end_hour&&t.includes(e.isoWeekday())},_utcOffset(e){const t=1===Math.sign(e)?"+":"-"
e=Math.abs(e)
let s=Math.floor(e/60).toString()
s=1===s.length?`0${s}`:s
let i=(e%60).toString()
return i=1===i.length?`:${i}0`:`:${i}`,`${t}${s.replace(/^0(\d)/,"$1")}${i.replace(/:00$/,"")}`.replace(/-0/,"&nbsp;")},_workingDays(){const e=moment().locale("en")
return this.siteSettings.working_days.split("|").filter(Boolean).map((t=>{return s=t,e.localeData()._weekdays.indexOf(s)||7
var s}))}})}))

//# sourceMappingURL=discourse-calendar-f9c0146b3feedc49ff730db1c66b952b624b753ea708327642774ec7f7e19be3.map
//!

;
